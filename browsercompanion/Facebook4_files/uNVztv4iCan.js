if (self.CavalryLogger) { CavalryLogger.start_js(["hBuPy"]); }

__d("FeedStoryCategory",[],(function a(b,c,d,e,f,g){f.exports={UNKNOWN:0,ORGANIC:1,ENGAGEMENT:2,FIXED_POSITION:3,PROMOTION:4,SPONSORED:5}}),null);
__d("InstanceProxy",[],(function a(b,c,d,e,f,g){__p&&__p();function h(i){"use strict";this.$InstanceProxy1=i}h.prototype.getInstance=function(){"use strict";return this.$InstanceProxy1};h.prototype.setInstance=function(i){"use strict";this.$InstanceProxy1=i};f.exports=h}),null);
__d("SLPerfTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();function h(){this.clear()}h.prototype.log=function(){c("GeneratedLoggerUtils").log("logger:SLPerfLoggerConfig",this.$SLPerfTypedLogger1,c("Banzai").BASIC)};h.prototype.logVital=function(){c("GeneratedLoggerUtils").log("logger:SLPerfLoggerConfig",this.$SLPerfTypedLogger1,c("Banzai").VITAL)};h.prototype.clear=function(){this.$SLPerfTypedLogger1={};return this};h.prototype.updateData=function(j){this.$SLPerfTypedLogger1=babelHelpers["extends"]({},this.$SLPerfTypedLogger1,j);return this};h.prototype.setCount=function(j){this.$SLPerfTypedLogger1.count=j;return this};h.prototype.setDurationMs=function(j){this.$SLPerfTypedLogger1.duration_ms=j;return this};h.prototype.setEvent=function(j){this.$SLPerfTypedLogger1.event=j;return this};h.prototype.setVC=function(j){this.$SLPerfTypedLogger1.vc=j;return this};var i={count:true,duration_ms:true,event:true,vc:true};f.exports=h}),null);
__d("SLUtils",["csx","cx","Arbiter","DOM","Event","FeedAdsClickLogger","LitestandMessages","LitestandStream","Map","MutationObserver","Run","SLConfig","SLPerfTypedLogger","URI","clearTimeout","curry","cxodecode","goURI","joinClasses","setTimeoutAcrossTransitions"],(function a(b,c,d,aa,e,ba,ca,da){"use strict";__p&&__p();var f=false,g=[],h=!!(b.MutationObserver||b.WebKitMutationObserver);function i(Q,R){__p&&__p();var S;if(f)return;f=true;if(!c("SLConfig").gk.s_link_utils)return;if(J()){L().setEvent("init").log();N("init_timer")}j();if(c("SLConfig").gk.sl_replace_about_link)p(function(V,W){return q(V,W)});if(c("SLConfig").gk.sl_replace_s)(function(){__p&&__p();C(Q);var V=R.map(function(W){return{nonce:c("cxodecode")(W.nonce),className:c("cxodecode")(W.className)}});p(function(W,X){V.forEach(function(Y){var Z=c("DOM").scry(W,Y.nonce);Z.forEach(function($){while($.firstChild)$.removeChild($.firstChild);$.className=c("joinClasses")($.className,Y.className)})})})})();if(c("SLConfig").gk.sl_replace_subtitle&&h){var T=H(),U=new(c("MutationObserver"))(function(){return z()});U.observe(T,{childList:true,subtree:true});F();p(function(V,W){x(V,W);y(W)})}m();if(J())L().setEvent("init_duration").setDurationMs(O("init_timer")).log()}function j(){c("Arbiter").subscribe(c("LitestandMessages").STORIES_INSERTED,m);c("Arbiter").subscribe("FeedAdsClickLogger/refreshTrackingData",m,c("Arbiter").SUBSCRIBE_NEW)}function k(){if(J())N("cleanup_timer");g.forEach(function(Q){Q.unsubscribe()});f=false;g=[];if(J())L().setEvent("cleanup_duration").setDurationMs(O("cleanup_timer")).log()}var l=null;function m(){__p&&__p();if(J())N("hsa_timer");c("clearTimeout")(l);l=null;var Q=[],R=t(),S=I(),T=false;S.forEach(function(U){__p&&__p();if(!U.id)return;if(R.has(U.id))return;if(!w(U,U.id)){T=true;return}R.set(U.id,U);Q.push([U,U.id])});if(T){l=c("setTimeoutAcrossTransitions")(m,c("SLConfig").sv.sl_content_waiting_delay);if(J())L().setEvent("hsa_waiting_for_content").log()}if(J())L().setEvent("hsa_stories_added").setCount(Q.length).log();if(Q.length===0)return;Q.forEach(function(U){var V=U[0],W=U[1];return o().forEach(function(X){return X(V,W)})});if(J())L().setEvent("hsa_duration").setDurationMs(O("hsa_timer")).log()}var n=[];function o(){return n}function p(Q){n.push(Q)}function q(Q,R){__p&&__p();var S=w(Q,R);if(!S){if(J())L().setEvent("usl_real_subtitle_missing").log();return}var T=c("DOM").scry(S,"a"),U=T.filter(function(V){var W=new(c("URI"))(V.href).getPath();return W==="/ads/about"||W==="/about/ads"});if(J())L().setEvent("usl_links_updated").setCount(U.length).log();U.forEach(function(V){var W=c("FeedAdsClickLogger").buildURL(V);c("Event").listen(V,"click",c("curry")(r,W));V.href="#"})}function r(Q,R){c("goURI")(Q.toString().replace("__md__=0","__md__=1"));c("Event").stop(R)}var s=new(c("Map"))();function t(){return s}var u=new(c("Map"))(),v=new(c("Map"))();function w(Q,R){var S=null;if(u.has(R))S=u.get(R);else S=Q;var T=c("DOM").scry(S,"._5pcp");if(T.length===0)return null;else return T[0]}function x(Q,R){__p&&__p();if(u.has(R)||v.has(R))return;var S=E();if(!S){if(J())L().setEvent("es_subtitle_container_missing").log();return}var T=c("DOM").scry(Q,"._5pcp");if(J())L().setEvent("es_subtitle_count").setCount(T.length).log();if(T.length===0)return;var U=T[0],V=U.parentNode;if(!U||!V)return;var W=A();U.parentNode.replaceChild(W,U);var X=B(U);S.appendChild(X);u.set(R,X);v.set(R,W)}function y(Q){__p&&__p();if(K())N("usp_timer");var R=H();if(!R){if(J())L().setEvent("usp_feed_root_missing").log();return}var S=v.get(Q);if(!S){if(J())L().setEvent("usp_fake_missing").log();return}var T=u.get(Q);if(!T){if(J())L().setEvent("usp_real_missing").log();return}var U=R.getBoundingClientRect(),V=S.getBoundingClientRect(),W=V.top!==0&&V.left!==0;T.style.display=W?"initial":"none";T.style.top=V.top-U.top+"px";T.style.left=V.left-U.left+"px";if(K())L().setEvent("usp_duration").setDurationMs(O("usp_timer")).log()}function z(){if(K())N("eausp_duration");G();var Q=t();Q.forEach(function(R,S){x(R,S);y(S)});if(K())L().setEvent("eausp_duration").setDurationMs(O("eausp_duration")).setCount(Q.size).log()}function A(){return c("DOM").create("div",{"class":"_4kgx"})}function B(Q){return c("DOM").create("div",{style:"position: absolute; z-index: 1;"},Q)}function C(Q){var R=document.createElement("style");R.type="text/css";R.textContent=c("cxodecode")(Q);document.getElementsByTagName("head")[0].appendChild(R)}var D=null;function E(){return D}function F(){if(D)return;var Q=H();D=c("DOM").create("div",{style:"position: relative;"});Q.insertBefore(D,Q.firstChild)}function G(){if(!D)return;var Q=H();if(D.parentNode===Q)return;c("DOM").remove(D);Q.insertBefore(D,Q.firstChild)}function H(){return c("LitestandStream").getStreamRoot()||document.body}function I(){return c("DOM").scry(H(),"._5pat")}function J(){return!!c("SLConfig").gk.sl_perf_logging}function K(){return!!c("SLConfig").gk.sl_perf_logging_heavy}function L(){return new(c("SLPerfTypedLogger"))()}var M=new(c("Map"))();function N(Q){M.set(Q,Date.now())}function O(Q){var R=M.get(Q);return R==null?-1:Date.now()-R}c("Run").onBeforeUnload(k);var P={init:i};e.exports=P}),null);
__d("LikeConfirmer",["AsyncDialog","AsyncRequest"],(function a(b,c,d,e,f,g){__p&&__p();var h=false,i=false,j={likeContent:function k(){},like:function k(l,m){__p&&__p();this.likeContent=l;if(i)return;if(h)this.likeContent();else{var n=new(c("AsyncRequest"))().setURI("/like/confirm_like.php").setRelativeTo(m);c("AsyncDialog").send(n,function(o){i=true;o.subscribe("hide",this.onCloseLikeConfirmDialog.bind(this));o.setCausalElement(m)}.bind(this))}return false},isShowingConfirmation:function k(){return i},onCloseLikeConfirmDialog:function k(){i=false},likeSkipConfirmation:function k(l){h=l;this.likeContent()}};f.exports=j}),null);
__d("FeedBaseKeyboardController",["csx","AccessibilityLogger","Arbiter","AsyncDialog","AsyncRequest","Banzai","BanzaiNectar","BanzaiODS","CSS","DOM","DOMScroll","Event","Focus","KeyboardShortcuts","LikeConfirmer","NavigationMessage","Parent","ReactComposerEvents","ReactComposerIDGenerator","Run","Scroll","SubscriptionsHandler","UITinyViewportAction","Vector","ViewportBounds","emptyFunction","ge","getActiveElement","isAsyncScrollQuery","isElementNode","throttle"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=0;function j(){i=c("UITinyViewportAction").isTiny()?0:c("ViewportBounds").getTop()}function k(l){"use strict";this.root=l;this.init()}k.prototype.getStories=function(){"use strict"};k.prototype.getParentStory=function(l){"use strict"};k.prototype.isStory=function(l){"use strict"};k.prototype.isHoldoutStory=function(l){"use strict"};k.prototype.getHeadline=function(l){"use strict"};k.prototype.getPreviousStory=function(l){"use strict"};k.prototype.getNextStory=function(l){"use strict"};k.prototype.setSelected=function(l,m){"use strict"};k.prototype.clickLike=function(){"use strict"};k.prototype.clickComment=function(){"use strict"};k.prototype.clickShare=function(){"use strict"};k.prototype.clickSeeMore=function(){"use strict"};k.prototype.clickLeft=function(){"use strict"};k.prototype.clickRight=function(){"use strict"};k.prototype.openAttachment=function(){"use strict"};k.prototype.focusComposer=function(){"use strict";__p&&__p();var l=["pagelet_composer","pagelet_group_composer","pagelet_event_composer","profile_fig_composer","PageComposerPagelet_","PageComposerPagelet_Admin_View"],m=null;for(var n in l){m=c("ge")(l[n]);if(m)break}if(m){var o=c("DOM").scry(m,"textarea")[0];if(o){c("Focus").set(o);c("DOMScroll").scrollTo(m,true)}else{var p=c("DOM").scry(m,"div._36bx")[0],q=p&&p.id;if(c("ReactComposerIDGenerator").isComposerID(q)){c("Arbiter").inform(c("ReactComposerEvents").ACTIVATE_ATTACHMENT+p.id);c("DOMScroll").scrollTo(m,true)}}}};k.prototype.getScrollOffset=function(){"use strict";return 10+(this.scrollOffset||0)};k.prototype.getAnimationLength=function(l){"use strict";return Math.min(Math.abs(c("Vector").getElementPosition(l).y-c("ViewportBounds").getTop()-c("Scroll").getTop(document.body)),400)};k.prototype.findTop=function(){"use strict";var l=this.getStories();for(var m=0;m<l.length;m++)if(c("Vector").getElementPosition(l[m]).y>c("Vector").getScrollPosition().y)return l[m];return null};k.prototype.onLeave=function(){"use strict";this.subscriptions&&this.subscriptions.release()};k.prototype.getHelpDialogRequest=function(){"use strict";if(!this.dialogRequest){this.dialogRequest=new(c("AsyncRequest"))("/ajax/keyboard_shortcuts");this.dialogRequest.setReadOnly(true)}else if(this.dialogRequest.transport)return null;return this.dialogRequest};k.prototype.init=function(){"use strict";__p&&__p();c("Run").onLeave(this.onLeave.bind(this));this.subscriptions=new(c("SubscriptionsHandler"))();this.subscriptions.addSubscriptions(c("Arbiter").subscribe(c("NavigationMessage").NAVIGATION_BEGIN,this.onLeave.bind(this)),c("KeyboardShortcuts").register("j",this.vert.bind(this,1)),c("KeyboardShortcuts").register("k",this.vert.bind(this,-1)),c("KeyboardShortcuts").register("l",function(){var l=this.getParentStory(c("getActiveElement")());c("LikeConfirmer").like(function(){this.setSelected(l,false);this.clickLike()}.bind(this),c("getActiveElement")())}.bind(this),{filter:this.hasActiveStory.bind(this)}),c("KeyboardShortcuts").register("c",this.clickComment.bind(this),{filter:this.hasActiveStory.bind(this)}),c("KeyboardShortcuts").register("o",this.openAttachment.bind(this),{filter:this.hasActiveStory.bind(this)}),c("KeyboardShortcuts").register("p",this.focusComposer.bind(this)),c("KeyboardShortcuts").register("s",this.clickShare.bind(this),{filter:this.hasActiveStory.bind(this)}),c("KeyboardShortcuts").register("SLASH",function(){var l=this.getHelpDialogRequest();if(l){l.setRelativeTo(c("getActiveElement")());c("AsyncDialog").send(l)}}.bind(this),{filter:function l(event,m){return event.getModifiers().shift}}),c("KeyboardShortcuts").register("RETURN",this.clickSeeMore.bind(this),{filter:this.hasExpandableStoryInFocus.bind(this)}),c("KeyboardShortcuts").register("LEFT",this.clickLeft.bind(this),{filter:this.hasActiveStory.bind(this)}),c("KeyboardShortcuts").register("RIGHT",this.clickRight.bind(this),{filter:this.hasActiveStory.bind(this)}),c("Event").listen(this.root,"focusin",function(event){var l=event.getTarget();if(!this.isStory(l)){var m=c("DOM").isNodeOfType(l,["object","embed","iframe"]),n=this.getParentStory(l),o=this.selected;if(n&&!m&&o){this.setSelected(n,true);this.selected=n}}}.bind(this)))};k.prototype.hasActiveStory=function(event,l){"use strict";var m=c("getActiveElement")();return!(m&&c("CSS").shown(m))||!!this.getParentStory(m)};k.prototype.hasExpandableStoryInFocus=function(event,l){"use strict";var m=c("getActiveElement")();return!!(m.getElementsByClassName("text_exposed_root").length&&!m.getElementsByClassName("text_exposed_root text_exposed").length)};k.prototype.clickElement=function(l){"use strict";__p&&__p();if(!l)return;var m=void 0;for(var n=arguments.length,o=Array(n>1?n-1:0),p=1;p<n;p++)o[p-1]=arguments[p];for(var q=0,r=o.length;q<r;q++){m=c("DOM").scry(l,o[q])[0];if(m&&c("CSS").shown(m)){m.click();return}}};k.prototype.click=function(){"use strict";for(var l=arguments.length,m=Array(l),n=0;n<l;n++)m[n]=arguments[n];this.clickElement.apply(this,[this.selected].concat(m))};k.prototype.$FeedBaseKeyboardController1=function(){"use strict";__p&&__p();if(!this.$FeedBaseKeyboardController2){this.scrollOffset=0;var l=c("ge")("pagelet_feed_switcher_root");if(l)this.scrollOffset+=l.getBoundingClientRect().height;this.subscriptions.addSubscriptions(c("Event").listen(document,"scroll",function(){if(this.selected&&!this.scrolling)this.setSelected(null,false)}.bind(this)));this.$FeedBaseKeyboardController2=true}};k.prototype.$FeedBaseKeyboardController3=function(){"use strict";if(!this.$FeedBaseKeyboardController4){j();this.subscriptions.addSubscriptions(c("Event").listen(window,"resize",c("throttle")(j)));this.$FeedBaseKeyboardController4=true}};k.prototype.vert=function(l){"use strict";__p&&__p();this.$FeedBaseKeyboardController1();var m,n;if(this.selected){if(c("Banzai").isEnabled("kbshortcuts_feed")){n=l>0?"kbshortcuts.scroll_down":"kbshortcuts.scroll_up";c("BanzaiODS").bumpEntityKey("kbshortcuts_feed",n);c("BanzaiNectar").log("feed_scroll",n,{})}c("AccessibilityLogger").logJKKey();if(this.selected.id=="pagelet_composer"){m=l>0?this.getStories()[0]:null;if(this.isHoldoutStory(m))m=this.getPreviousStory(m)}else if(l===0)m=this.selected;else m=l>0?this.getNextStory(this.selected):this.getPreviousStory(this.selected)||c("ge")("pagelet_composer");if(!m)return;else if(!c("isElementNode")(m)||c("CSS").hasClass(m,"hidden_elem")){c("CSS").removeClass(this.selected,"selectedStorySimple");this.selected=m;this.vert(l);return}}if(!m||c("Parent").byClass(m,"hidden_elem")||!c("DOM").contains(document,m)){m=this.findTop();if(m&&l<0)m=this.getPreviousStory(m);if(this.isHoldoutStory(m))m=this.getPreviousStory(m)}if(!m)return;this.anim&&this.anim.stop();var o=Date.now()-(this.lastScroll||0)>30,p=c("emptyFunction");if(l!==0)p=this.setFocused.bind(this,m);if(c("isAsyncScrollQuery")()){o=false;p();p=c("emptyFunction")}this.scrolling=true;this.scrollingTimer&&clearTimeout(this.scrollingTimer);this.$FeedBaseKeyboardController3();this.anim=c("DOMScroll").scrollTo(m,o?this.getAnimationLength(m):0,false,c("Vector").getViewportDimensions().y-i-this.getScrollOffset(),0,function(){this.scrollingTimer=setTimeout(function(){this.scrolling=false}.bind(this),300);var q=c("Vector").getScrollPosition();p();if(q.distanceTo(c("Vector").getScrollPosition())!==0)c("DOMScroll").scrollTo(q,0)}.bind(this));this.setSelected(m,true);this.lastScroll=Date.now()};k.prototype.setTabindexOnStory=function(l,m){"use strict";if(this.isStory(l))l.tabIndex=m};k.prototype.setFocused=function(l){"use strict";if(this.isStory(l))c("Focus").setWithoutOutline(l)};f.exports=k}),null);
__d("FeedTrackingAsync",["Arbiter","Run","collectDataAttributes"],(function a(b,c,d,e,f,g){__p&&__p();var h;f.exports.init=function(){__p&&__p();if(h)return;h=c("Arbiter").subscribe("AsyncRequest/send",function(i,j){var k=j.request,l=k.getRelativeTo();if(l){var m=k.getData(),n=c("collectDataAttributes")(l,["ft"]);if(n.ft&&Object.keys(n.ft).length)Object.assign(m,n)}});c("Run").onLeave(function(){h.unsubscribe();h=null})}}),null);
__d("AdAllocationIntegrityGapsInfo",["FeedStoryCategory"],(function a(b,c,d,e,f,g){__p&&__p();function h(i){"use strict";this.story_category=i;this.dist_to_top=-1;this.dist_to_fixed=-1;this.dist_to_promo=-1;this.dist_to_sponsored=-1;this.dist_to_engagement=-1}h.prototype.setDistToTop=function(i){"use strict";this.dist_to_top=i};h.prototype.setDistIfAbsent=function(i,j){"use strict";__p&&__p();if(j<0||i===c("FeedStoryCategory").UNKNOWN||i===c("FeedStoryCategory").ORGANIC)return;switch(i){case c("FeedStoryCategory").ENGAGEMENT:this.dist_to_engagement=this.$AdAllocationIntegrityGapsInfo1(j,this.dist_to_engagement);break;case c("FeedStoryCategory").FIXED_POSITION:this.dist_to_fixed=this.$AdAllocationIntegrityGapsInfo1(j,this.dist_to_fixed);break;case c("FeedStoryCategory").PROMOTION:this.dist_to_promo=this.$AdAllocationIntegrityGapsInfo1(j,this.dist_to_promo);break;case c("FeedStoryCategory").SPONSORED:this.dist_to_sponsored=this.$AdAllocationIntegrityGapsInfo1(j,this.dist_to_sponsored);break}};h.prototype.$AdAllocationIntegrityGapsInfo1=function(i,j){"use strict";if(j===-1)return i;return j};f.exports=h}),null);
__d("AdAllocationIntegrityUtils",["FeedStoryCategory","collectDataAttributes","DataAttributeUtils"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h="data-story_category",i="data-dedupekey",j="ft",k={getFeedStoryCategory:function l(m){__p&&__p();var n=c("collectDataAttributes")(m,[j]).ft,o=c("DataAttributeUtils").getDataAttribute(m,h);if(o)switch(o){case"2":return c("FeedStoryCategory").ENGAGEMENT;case"3":return c("FeedStoryCategory").FIXED_POSITION;case"4":return c("FeedStoryCategory").PROMOTION;default:return c("FeedStoryCategory").UNKNOWN}else if(n.ei)return c("FeedStoryCategory").SPONSORED;else return c("FeedStoryCategory").ORGANIC},isGapRuleCategory:function l(m){if(m===c("FeedStoryCategory").SPONSORED||m===c("FeedStoryCategory").ENGAGEMENT||m===c("FeedStoryCategory").FIXED_POSITION||m===c("FeedStoryCategory").PROMOTION)return true;else return false},getDedupKey:function l(m){return c("DataAttributeUtils").getDataAttribute(m,i)}};f.exports=k}),null);
__d("AsyncLayout",["AjaxPipeRequest","Arbiter","AsyncRequest","AsyncResponse","CSS","FaceliftGating","DOM","HTML","NavigationMessage","PageTransitionsRegistrar","URI","$","emptyFunction","ge","goURI","requireWeak"],(function a(b,c,d,e,f,g){__p&&__p();var h;c("requireWeak")("PageTransitions",function(j){h=j});function i(j){"use strict";__p&&__p();this.canvasID=j;if(c("ge")("rightCol"))this.auxiliaryID="rightCol";if(c("ge")("headerArea"))this.headerID="headerArea";if(c("ge")("toolbarContainer"))this.toolbarID="toolbarContainer";this.waitingForAux=false;c("PageTransitionsRegistrar").registerHandler(this.catchPageTransition.bind(this));this.subscription=c("Arbiter").subscribe(c("NavigationMessage").NAVIGATION_BEGIN,this.onNavigate.bind(this));c("Arbiter").inform("AsyncLayout/initialized",null,c("Arbiter").BEHAVIOR_STATE)}i.prototype.catchPageTransition=function(j){"use strict";this.subscription.unsubscribe();return false};i.prototype.getCanvasID=function(j){"use strict";return j.sidecol?"contentCol":"contentArea"};i.prototype.onNavigate=function(j,k){"use strict";__p&&__p();var l=k.useAjaxPipe;k=k.params;if(k.endpoint){if(this.request){this.request.setFinallyHandler(c("emptyFunction"));this.request.abort()}if(l){k.xui_grid=c("FaceliftGating").hasXUIGrid;this.request=new(c("AjaxPipeRequest"))().setURI(k.endpoint).setData(k).setCanvasId(this.getCanvasID(k)).setFinallyHandler(this.finallyHandler.bind(this)).setErrorHandler(this.errorHandler.bind(this)).setFirstResponseCallback(this.firstResponseCallback.bind(this)).send()}else{k.handled=true;this.waitingForAux=k.sidecol;var m=!!k.iframe,n=new(c("AsyncRequest"))().setOption("useIframeTransport",m).setURI(new(c("URI"))(k.endpoint)).setReadOnly(true).setMethod("GET").setData(k).setHandler(this.onResponse.bind(this)).setErrorHandler(this.errorHandler.bind(this)).setFinallyHandler(this.finallyHandler.bind(this));this.request=n;n.send()}}};i.prototype.receivedAux=function(j){"use strict";!this.waitingForAux;this.waitingForAux=false;c("DOM").setContent(c("$")(this.auxiliaryID),c("HTML")(j))};i.prototype.onResponse=function(j){"use strict";__p&&__p();var k=j.getPayload();if(k.redirect)c("goURI")(k.redirect);else{var l=k.html||k;c("DOM").setContent(c("$")(this.canvasID),c("HTML")(l));if(k.side_html&&this.auxiliaryID)this.receivedAux(k.side_html);if(this.headerID&&!k.keep_header){var m=c("$")(this.headerID);c("DOM").setContent(m,c("HTML")(k.header_html||""));c("CSS").conditionShow(m,k.header_html)}if(k.toolbar_html&&this.toolbarID)c("DOM").setContent(c("$")(this.toolbarID),c("HTML")(k.toolbar_html));if(k.js)new Function(k.js)();c("CSS").conditionClass(c("$")("contentCol"),"hasRightCol",this.auxiliaryID&&!k.noRightSide);var n=c("ge")("rightCol");if(n&&k.noRightSide)c("DOM").empty(n)}var o=j.getRequest().getData();c("Arbiter").inform(c("NavigationMessage").NAVIGATION_COMPLETED,o.key)};i.prototype.errorHandler=function(j){"use strict";c("AsyncResponse").verboseErrorHandler(j);c("Arbiter").inform(c("NavigationMessage").NAVIGATION_FAILED);this.request=null};i.prototype.firstResponseCallback=function(){"use strict";window.scrollTo(0,0);c("Arbiter").inform(c("NavigationMessage").NAVIGATION_FIRST_RESPONSE)};i.prototype.finallyHandler=function(j){"use strict";this.request=null;if(h)h.transitionComplete(true);c("Arbiter").inform(c("NavigationMessage").NAVIGATION_COMPLETED)};f.exports=i}),null);
__d("DimensionLogging",["BanzaiNectar","getViewportDimensions"],(function a(b,c,d,e,f,g){var h=c("getViewportDimensions")();c("BanzaiNectar").log("browser_dimension","homeload",{x:h.width,y:h.height,sw:window.screen.width,sh:window.screen.height,aw:window.screen.availWidth,ah:window.screen.availHeight,at:window.screen.availTop,al:window.screen.availLeft})}),null);
__d("ViewportTrackingHooks",["Base64"],(function a(b,c,d,e,f,g){__p&&__p();var h={},i=[],j={registerFeedObject:function k(l,m){h[l]=c("Base64").encode(m)},updateVisibleViewportObjects:function k(l){__p&&__p();var m=[],n=false;for(var o=0;o<l.length;o++){var p=l[o],q=p.id;while(!(q in h)&&p.firstChild!=undefined&&p.firstChild.id!=undefined&&p.firstChild.id.startsWith("u_")){q=p.firstChild.id;p=p.firstChild}if(q in h){m.push(h[q]);if(!(o in i)||i[o]!=h[q])n=true}}if(!n&&i.length!=m.length)n=true;if(n){i=m;if(typeof __EXT__updateVisibleViewportObjects==="function")__EXT__updateVisibleViewportObjects(i)}}};f.exports=j}),null);
__d("viewportTrackingBuilder",[],(function a(b,c,d,e,f,g){"use strict";var h=function h(i){var j=null;return{factory:i,singleton:function k(){if(!j)j=i.apply(undefined,arguments);return j},clearSingleton:function k(){j=null}}};f.exports=h}),null);
__d("ViewportTracking",["cx","invariant","AdAllocationIntegrityGapsInfo","AdAllocationIntegrityUtils","Arbiter","Banzai","BanzaiScuba","CSS","CurrentUser","DOM","DOMDimensions","Event","LitestandMessages","NavigationMessage","pageID","Run","SubscriptionsHandler","TimeSlice","UserActivity","ViewportTrackingHelper","ViewportTrackingHooks","clickRefAction","collectDataAttributes","debounce","getElementPosition","getViewportDimensions","throttle","viewportTrackingBuilder","setTimeout"],(function a(b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=97,k="vpv",l=3,m=2,n=1,o=0,p=1,q=2,r=3,s=4;function t(w){this.cachedAllStories=[];this.cachedVisibleStories={init:false,data:{}};this.fireTimer=this.fireTimer.bind(this);this.logAnnotatedVPV=this.logAnnotatedVPV.bind(this);this.markStoryRead=this.markStoryRead.bind(this);this.behavior=w}t.prototype.init=function(w){__p&&__p();this.useBanzai=true;this.vpvDebug=!!w.vpv_debug;this.vpvdDebug=!!w.vpvd_debug;this.vpvdAnalysis=!!w.vpvd_analysis;this.trackingHooks=!!w.tracking_hooks;this.ctaLoggingEnabled=!!w.cta_logging_enabled;this.adAllocationIntegrityLoggingEnabled=!!w.ad_allocation_integrity_logging_enabled;this.readStoryIDs={};this.annotatedStoryIDs={};this.minSizeToBeVisible=200;this.storyIDsWasInView={};this.minFractionToBeVisibleForTimetracking=.5;this.scrollThrottlingInterval=100;this.mouseThrottlingInterval=100;this.keyboardThrottlingInterval=100;this.minTimeToReportImmediately=500;this.discardVPVDIntervalThreshold=9e4;this.active_state_duration=1e3;this.height_diff_to_change_state=25;this.focused_state_duration=3500;this.invalidateAllStoriesCache();this.cachedViewportHeight=c("getViewportDimensions")().height;this.isTimetrackingEnabled=false;this.activeStories={};this.userInactiveLock=false;this.userActivityPollerTimeoutID=-1;this._headLoadStoryCount=0;if(this.behavior.getDataFromConfig)this.behavior.getDataFromConfig(w,this);if(this.isTimetrackingEnabled){this.lastMouseX=-1;this.lastMouseY=-1;this.lastStreamY=-1;this.latestStreamYChangedTimeStamp=-1;this.userFocus=q;this.latestUserFocus=q;this.latestUserActivity="init";this.focusedStory=null;this.latestFocusedStory=null;this.latestActiveStory=null;this.totalVPVDuration={}}if(w.tracking_duration_config){this.scrollThrottlingInterval=w.tracking_duration_config.scroll_throttling_interval;this.mouseThrottlingInterval=w.tracking_duration_config.mouse_throttling_interval;this.keyboardThrottlingInterval=w.tracking_duration_config.keyboard_throttling_interval;this.userActivityPollingInterval=w.tracking_duration_config.user_activity_polling_interval;this.timeToBeConsideredInactive=w.tracking_duration_config.time_to_be_considered_inactive;this.minFractionToBeVisibleForTimetracking=w.tracking_duration_config.min_fraction_to_be_visible;this.minTimeToReportImmediately=w.tracking_duration_config.min_time_to_report_immediately;this.active_state_duration=w.tracking_duration_config.active_state_duration;this.height_diff_to_change_state=w.tracking_duration_config.story_height_diff_to_change_state;this.focused_state_duration=w.tracking_duration_config.focused_state_duration;this.discardVPVDIntervalThreshold=w.tracking_duration_config.discard_vpvd_interval_threshold}w.record_delay!==undefined||i(0);var x=c("debounce")(this.fireTimer,w.record_delay,this);this.initialStories=this.getStoriesInView();this.initialStoriesLogged=false;if(this.annotatedVPVLogging)this.initialStories.forEach(this.logAnnotatedVPV,this);this.subscriptions=new(c("SubscriptionsHandler"))();this.subscriptions.addSubscriptions(this._getScrollListener(x),c("Event").listen(window,"resize",function(){this.invalidateVisibleStoriesCache();this.cachedViewportHeight=c("getViewportDimensions")().height;x()}.bind(this)),c("Event").listen(window,"focus",function(){if(this.isTimetrackingEnabled)this.updateTimeTrackingData(false,"window_focus")}.bind(this)),c("Event").listen(window,"blur",function(){if(this.isTimetrackingEnabled)this.updateTimeTrackingData(true,"window_blur")}.bind(this)),c("Arbiter").subscribe(c("NavigationMessage").NAVIGATION_BEGIN,this.cleanup.bind(this)),c("Arbiter").subscribe("Stream/totalHeadLoadedStories",function(B,C){this._headLoadStoryCount=C.count}.bind(this)),c("Arbiter").subscribe(c("LitestandMessages").STORIES_INSERTED,function(){if(!this.initialStoriesLogged){var B=this.getStoriesInView();B.forEach(this.logAnnotatedVPV,this)}else x();if(this.isTimetrackingEnabled)this.updateTimeTrackingData(false,"stories_inserted")}.bind(this)));if(this.isTimetrackingEnabled&&this.behavior.getStream){this.updateTimeTrackingData(false,"init");var y=c("throttle")(function(event){this.invalidateVisibleStoriesCache();this.handleScroll(event)}.bind(this),this.scrollThrottlingInterval),z=c("throttle")(function(event){return this.handleKeyboard(event)}.bind(this),this.keyboardThrottlingInterval),A=c("throttle")(function(event){return this.handleMouse(event)}.bind(this),this.mouseThrottlingInterval);this.subscriptions.addSubscriptions(c("Event").listen(window,"scroll",y),c("Event").listen(document.documentElement,"DOMMouseScroll",y,undefined,{passive:true}),c("Event").listen(document.documentElement,"mousewheel",y,undefined,{passive:true}),c("Event").listen(document.documentElement,"keydown",z),c("Event").listen(document.documentElement,"mouseover",A),c("Event").listen(document.documentElement,"mousemove",A),c("Event").listen(document.documentElement,"click",function(event){this.handleMouse(event)}.bind(this)),c("Arbiter").subscribe("Event/stop",function(B,C){this.handleMouse(C.event)}.bind(this)),c("Arbiter").subscribe("PhotoSnowlift.OPEN",function(){this.userFocus=r;this.handleLayers()}.bind(this)),c("Arbiter").subscribe("PhotoSnowlift.CLOSE",function(){this.userFocus=p;this.focusedStory=null;this.updateTimeTrackingData(false,"snowlift_close")}.bind(this)));this._userActivityPoller()}c("Run").onLeave(this.cleanup.bind(this));c("Run").onUnload(this.cleanup.bind(this))};t.prototype._getScrollListener=function(w){return c("Event").listen(window,"scroll",w)};t.prototype.cleanup=function(){__p&&__p();if(this.subscriptions){this.subscriptions.release();this.subscriptions=null}if(this.isTimetrackingEnabled){clearTimeout(this.userActivityPollerTimeoutID);this.updateTimeTrackingData(true,"cleanup")}if(this.annotatedVPVLogging){var w=this.getStoriesInView();w.forEach(this.logAnnotatedVPV,this)}this.initialStories=[];this._headLoadStoryCount=0};t.prototype.fireTimer=function(){__p&&__p();if(!this.initialStoriesLogged){this.initialStories.forEach(this.markStoryRead,this);this.initialStoriesLogged=true}this.storiesInView=this.getStoriesInView();this.storiesInView.forEach(this.markStoryRead,this);if(this.trackingHooks){var w=this.isTimetrackingEnabled?this.getVisibleStoriesFromCache():this.getAllStoriesInView(),x=[],y=Object.keys(w);for(var z=0,A=y.length;z<A;z++){var B=y[z];if(w[B].story)x.push(w[B].story)}c("ViewportTrackingHooks").updateVisibleViewportObjects(x)}};t.prototype.getSessionID=function(){return null};t.prototype._userActivityPoller=function(){__p&&__p();if(!this.userInactiveLock&&!c("UserActivity").isActive(this.timeToBeConsideredInactive)){this.userInactiveLock=true;this.userFocus=q;this.updateTimeTrackingData(false,"user_activity_inactive");c("UserActivity").subscribeOnce(function(){this.userFocus=p;this.updateTimeTrackingData(false,"user_activity_active");this.userInactiveLock=false}.bind(this))}this.userActivityPollerTimeoutID=c("setTimeout")(c("TimeSlice").guard(this._userActivityPoller.bind(this),"ViewportTracking poll setTimeout",{isContinuation:false}),this.userActivityPollingInterval)};t.prototype.getQueryID=function(w){return-1};t.prototype.getFBFeedLocations=function(w){return-1};t.prototype.getFBFeedInsertionPosition=function(w){return-1};t.prototype.createVPVDTimer=function(w){var x=document.createElement("label");x.setAttribute("for",w.toString());x.setAttribute("class","vpvd_debug_timer");return x};t.prototype.updateVPVDTimer=function(w){__p&&__p();var x=this.activeStories[w].story;if(!x)return;var y=c("DOM").scry(x,".vpvd_debug_timer");if(!y.length){y=[this.createVPVDTimer(x),this.createVPVDTimer(x)];var z=c("DOM").scry(x,".UFIRow");if(z.length&&z[z.length-1].clientWidth>0)z[z.length-1].appendChild(y[0]);else x.appendChild(y[0]);x.insertBefore(y[1],x.firstChild)}var A=this.totalVPVDuration[w],B=Math.floor(A/1e3)+"."+Math.floor(A%1e3/100);c("DOM").setContent(y[0],B);c("DOM").setContent(y[1],B)};t.prototype.updateVPVDTimers=function(){for(var w in this.activeStories)if(Object.prototype.hasOwnProperty.call(this.activeStories,w))this.updateVPVDTimer(w)};t.prototype.logVpvdAnalysis=function(w,x,y,z,A,B){__p&&__p();var C=new(c("BanzaiScuba"))("vpv_duration");C.addDenorm("qid",this.getQueryID(this.activeStories[w].story));C.addDenorm("uid",c("CurrentUser").getID());C.addDenorm("vsid",w);C.addInteger("time",Math.round(Date.now()/1e3));C.addInteger("duration",z);C.addInteger("total_duration",A);C.addNormal("story_state",this.activeStories[w].state);C.addNormal("is_active_state",y);C.addNormal("num_visible_stories",this.numVisibleStories);C.addInteger("story_height",this.activeStories[w].story_height);C.addInteger("story_visible_height",this.activeStories[w].height);C.addInteger("state_visible_height",B);C.addInteger("total_visible_height",this.totalVisibleHeight);C.addInteger("total_height",this.totalHeight);C.addNormal("user_focus",this.latestUserFocus);C.addNormal("next_user_focus",this.userFocus);C.addInteger("vpvd",x);C.addInteger("accumulated_vpvd",this.activeStories[w].vpvd);C.addNormal("user_activity",this.latestUserActivity);C.addNormal("next_user_activity",this.userActivity);C.addInteger("story_position_y",this.activeStories[w].y);C.addInteger("feed_insertion_position",this.getFBFeedInsertionPosition(this.activeStories[w].story));C.addNormal("visible_position",this.activeStories[w].visible_position);C.addNormal("is_focused_story",this.activeStories[w].is_focused);C.post()};t.prototype.shouldDiscardStory=function(w){var x=this.activeStories[w].height||0;return x!=this.activeStories[w].story_height&&x<this.totalHeight/2};t.prototype.calculateTotalHeight=function(){this.totalHeight=0;for(var w in this.activeStories)if(Object.prototype.hasOwnProperty.call(this.activeStories,w))this.totalHeight+=this.activeStories[w].height};t.prototype.updateVPVDurations=function(w){__p&&__p();var x;if(this.latestUserFocus===q||w-this.latestTimeTrackingTimestamp>this.discardVPVDIntervalThreshold)return;var y=(x={},x[n]=0,x[m]=0,x[l]=0,x),z=w-this.latestTimeTrackingTimestamp>=this.focused_state_duration;this.totalVisibleHeight=0;for(var A in this.activeStories)if(Object.prototype.hasOwnProperty.call(this.activeStories,A))if(!(this.latestUserFocus===p&&z&&this.shouldDiscardStory(A))){var B=this.activeStories[A].state||null,C=this.activeStories[A].height||0;if(B!==null&&Object.prototype.hasOwnProperty.call(y,B))y[B]+=C;this.totalVisibleHeight+=C}var D=0,E=w-this.latestTimeTrackingTimestamp;if(this.latestUserFocus===p){E=y[l]>0?this.focused_state_duration:this.active_state_duration;E=Math.min(E,w-this.latestTimeTrackingTimestamp);D=w-this.latestTimeTrackingTimestamp-E}var F=0,G=l;for(var H=l;H>=n;H--)if(y[H]>0){F=y[H];G=H;break}var I=y[l]+y[m]+y[n],J=0;for(A in this.activeStories)if(Object.prototype.hasOwnProperty.call(this.activeStories,A)){if(this.latestUserFocus===p&&z&&this.shouldDiscardStory(A))continue;var K=this.activeStories[A].state||o;if(F>0&&K>=G){var L=this.activeStories[A].height||0;J=E*(L/F);if(this.vpvdAnalysis&&E>0)this.logVpvdAnalysis(A,J,true,E,E+D,F);this.activeStories[A].vpvd+=J;this.totalVPVDuration[A]+=J}if(I>0){var M=this.activeStories[A].height||0;J=D*(M/I);if(this.vpvdAnalysis&&D>0)this.logVpvdAnalysis(A,J,false,D,E+D,I);this.activeStories[A].vpvd+=J;this.totalVPVDuration[A]+=J}}};t.prototype.updateActiveStory=function(w,x,y,z){this.activeStories[w].state=x;this.activeStories[w].ts=y;this.activeStories[w].height_snapshot=z[w].height;this.activeStories[w].is_focused=this.focusedStory===z[w].story;this.activeStories[w].story_height=z[w].story_height;if(this.vpvdAnalysis){this.activeStories[w].visible_position=z[w].visible_position;this.activeStories[w].y=z[w].y}};t.prototype.updateActiveStories=function(w,x){__p&&__p();for(var y in w)if(Object.prototype.hasOwnProperty.call(w,y))if(y in this.activeStories){var z=w[y].height||0;this.activeStories[y].height=z;var A=z-(this.activeStories[y].height_snapshot||0);if(this.focusedStory===w[y].story)this.updateActiveStory(y,l,x,w);else if(A<=-this.height_diff_to_change_state)this.updateActiveStory(y,this.shouldDiscardStory(y)?o:n,x,w);else if(A>=this.height_diff_to_change_state||this.activeStories[y].is_focused||this.activeStories[y].height===this.activeStories[y].story_height)this.updateActiveStory(y,m,x,w)}else{this.storyIDsWasInView[y]=true;this.activeStories[y]={evp_ts:x,story:w[y].story,height:w[y].height,vpvd:0};if(!this.totalVPVDuration[y])this.totalVPVDuration[y]=0;this.updateActiveStory(y,m,x,w)}};t.prototype.recordVPVDurations=function(w,x){for(var y in this.activeStories)if(Object.prototype.hasOwnProperty.call(this.activeStories,y))if(x||!(y in w)){var z=this.activeStories[y].vpvd||0;if(z>this.focused_state_duration||z===this.totalVPVDuration[y])this.recordTimeStoryWasInView(this.activeStories[y]);delete this.activeStories[y]}};t.prototype.updateTimeTrackingData=function(w,x){__p&&__p();this.userActivity=x;if(!this.activeStories)this.activeStories={};var y=Date.now();if(!this.latestTimeTrackingTimestamp)this.latestTimeTrackingTimestamp=y;var z=this.getVisibleStoriesFromCache();this.calculateTotalHeight();this.updateVPVDurations(y);this.updateActiveStories(z,y);if(this.vpvdDebug)this.updateVPVDTimers();this.recordVPVDurations(z,w);if(w)this.latestTimeTrackingTimestamp=0;else this.latestTimeTrackingTimestamp=y;this.latestUserActivity=this.userActivity;this.latestUserFocus=this.userFocus;if(this.focusedStory)this.latestActiveStory=this.focusedStory;this.latestFocusedStory=this.focusedStory;this.focusedStory=null};t.prototype.needsToUpdateTimeTrackingData=function(){return!(this.latestUserFocus===this.userFocus&&(this.userFocus===q||this.userFocus===p&&!this.latestFocusedStory&&!this.focusedStory))};t.prototype.getfocusedStory=function(w){var x=this.getVisibleStoriesFromCache();for(var y in x)if(Object.prototype.hasOwnProperty.call(x,y)){var z=x[y].story;if(z&&c("ViewportTrackingHelper").isDescendantOf(w,z))return z}return null};t.prototype.handleLayers=function(){if(this.userFocus===r||this.userFocus===s){this.focusedStory=this.latestActiveStory;this.updateTimeTrackingData(false,"media_layer");return true}return false};t.prototype.didInteractWithStream=function(w){if(!this.behavior.getStream)return false;var x=this.behavior.getStream();return c("ViewportTrackingHelper").isDescendantOf(w,x)||c("ViewportTrackingHelper").isDescendantOf(x,w)};t.prototype.handleScroll=function(event){__p&&__p();if(this.handleLayers())return;var w=Date.now();this.behavior.getStream||i(0);var x=c("getElementPosition")(this.behavior.getStream()).y;if(x!=this.lastStreamY||w-this.latestStreamYChangedTimeStamp<2.5*this.scrollThrottlingInterval||this.didInteractWithStream(event.target)){this.latestStreamYChangedTimeStamp=w;this.userFocus=p}else this.userFocus=q;this.lastStreamY=x;if(this.userFocus===p||this.needsToUpdateTimeTrackingData())this.updateTimeTrackingData(false,"scroll")};t.prototype.handleKeyboard=function(event){__p&&__p();if(this.handleLayers())return;if(this.didInteractWithStream(event.target)){this.userFocus=p;this.focusedStory=this.getfocusedStory(event.target)}else if(c("CSS").hasClass(event.target,"shareInput")){this.userFocus=p;this.focusedStory=this.latestActiveStory}else this.userFocus=q;if(this.userFocus===p||this.needsToUpdateTimeTrackingData())this.updateTimeTrackingData(false,"keyboard")};t.prototype.handleMouse=function(event){__p&&__p();if(this.handleLayers())return;if(event.type!="click"&&event.clientX===this.lastMouseX&&event.clientY===this.lastMouseY)return;if(event.type==="click")this.invalidateVisibleStoriesCache();if(this.didInteractWithStream(event.target)){this.userFocus=p;this.focusedStory=this.getfocusedStory(event.target)}else this.userFocus=q;this.lastMouseX=event.clientX;this.lastMouseY=event.clientY;if(this.needsToUpdateTimeTrackingData())this.updateTimeTrackingData(false,event.type)};t.prototype.getStoriesInView=function(){__p&&__p();var w=this.behavior.getAllStories(),x=[],y=false;for(var z=0;z<w.length;z++){var A=w[z],B=this.behavior.getStoryID(A);if(B&&this.hasBeenVisible(B))continue;if(c("ViewportTrackingHelper").isVisible(A,this.minSizeToBeVisible)){if(A.getAttribute("data-insertion-position")===null)A.setAttribute("data-insertion-position",(z-this._headLoadStoryCount).toString());x.push(A);y=true}else if(y)break}return x};t.prototype.getAllStoriesFromCache=function(){if(this.cachedAllStories.length===0)this.cachedAllStories=this.behavior.getAllStories();return this.cachedAllStories};t.prototype.invalidateAllStoriesCache=function(){this.cachedAllStories=[];this.invalidateVisibleStoriesCache()};t.prototype.getVisibleStoriesFromCache=function(){if(!this.cachedVisibleStories.init)this.cachedVisibleStories={init:true,data:this.getAllStoriesInView()};return this.cachedVisibleStories.data};t.prototype.invalidateVisibleStoriesCache=function(){this.cachedVisibleStories={init:false,data:{}}};t.prototype.getAllStoriesInView=function(){__p&&__p();var w=this.getAllStoriesFromCache(),x={},y=false,z=0,A=w.length,B=1,C=w.length;if(this._indexOfLastVisibleStoryOnPreviousPass>A/2){z=A-1;A=-1;B=-B}for(var D=z;D!=A;D+=B){var E=w[D],F=c("ViewportTrackingHelper").getHeightIfVisible(E,Math.min(this.minSizeToBeVisible,this.minFractionToBeVisibleForTimetracking*c("DOMDimensions").getElementDimensions(E).height));if(F>0||E===this.focusedStory){if(E.getAttribute("data-insertion-position")===null)E.setAttribute("data-insertion-position",(D-this._headLoadStoryCount).toString());var G=this.behavior.getStoryID(E);if(G){x[G]={story:E,height:F,story_height:c("DOMDimensions").getElementDimensions(E).height};y=true;if(this.vpvdAnalysis){x[G].y=c("getElementPosition")(E).y;x[G].visible_position=D;C=Math.min(C,D)}}}else if(y){this._indexOfLastVisibleStoryOnPreviousPass=D-B;break}}if(this.vpvdAnalysis){this.numVisibleStories=0;for(G in x)if(Object.prototype.hasOwnProperty.call(x,G)){x[G].visible_position-=C;this.numVisibleStories++}}return x};t.prototype.getTimetrackingDataToLog=function(w){var x={evt:j,time_spent_id:c("pageID"),vpvd_start_timestamp:w.evp_ts||null,vpvd_time_delta:Math.round(w.vpvd||0),story_height:c("DOMDimensions").getElementDimensions(w.story).height,viewport_height:this.cachedViewportHeight};return{ft:x}};t.prototype.getGapsInfoToLog=function(w){__p&&__p();if(w===null||w===undefined)return null;var x=c("AdAllocationIntegrityUtils").getFeedStoryCategory(w),y=new(c("AdAllocationIntegrityGapsInfo"))(x);if(!c("AdAllocationIntegrityUtils").isGapRuleCategory(x))return y;else{var z=c("AdAllocationIntegrityUtils").getDedupKey(w);if(z===null)return null;var A=this.behavior.getAllStories().filter(function(F){return Object.prototype.hasOwnProperty.call(this.storyIDsWasInView,this.behavior.getStoryID(F))}.bind(this)),B=-1;for(var C=A.length-1;C>=0;C--){var D=c("AdAllocationIntegrityUtils").getDedupKey(A[C]);if(B<0){if(D!==null&&z===D){B=C;y.setDistToTop(B+1)}}else{var E=c("AdAllocationIntegrityUtils").getFeedStoryCategory(A[C]);if(c("AdAllocationIntegrityUtils").isGapRuleCategory(E))y.setDistIfAbsent(E,B-C)}}return y}};t.prototype.recordTimeStoryWasInView=function(w){__p&&__p();if(!this.isTimetrackingEnabled)return;if(!w.vpvd||!w.story)return;if(w.vpvd>0){var x=this.getTimetrackingDataToLog(w),y=c("collectDataAttributes")(w.story,["ft"]);Object.assign(x.ft,y.ft);if(this.adAllocationIntegrityLoggingEnabled){var z=this.getGapsInfoToLog(w.story);Object.assign(x.ft,z)}var A=!!y.ft.ei&&x.ft.vpvd_time_delta>this.minTimeToReportImmediately;if(x.ei)delete x.ei;w.story||i(0);this.sendDataToLog(w.story,x,A)}};t.prototype.hasBeenVisible=function(w){return w in this.readStoryIDs};t.prototype.sendDataToLog=function(w,x,y){__p&&__p();if(this.useBanzai){var z={};if(y)z.delay=3e3;var A=this.getSessionID();if(A)x.ft.session_id=A;c("Banzai").post("feed_tracking",x,z)}else c("clickRefAction")(k,w,null,"FORCE",x)};t.prototype.markStoryRead=function(w){__p&&__p();var x=this.behavior.getStoryID(w);if(!x||this.hasBeenVisible(x))return;this.readStoryIDs[x]=true;this.annotatedStoryIDs[x]=true;var y=this._getDataToLogImpl(w),z=c("collectDataAttributes")(w,["ft"]);Object.assign(y.ft,z.ft);delete y.ei;this.sendDataToLog(w,y,false);if(this.vpvDebug)c("CSS").addClass(w,"_5m7s")};t.prototype.logAnnotatedVPV=function(w){var x=this.behavior.getStoryID(w);if(!x||x in this.annotatedStoryIDs)return;this.annotatedStoryIDs[x]=true;var y=this._getDataToLogImpl(w),z=c("collectDataAttributes")(w,["ft"]);Object.assign(y.ft,z.ft);delete y.ei;y.ft.vpv_ft_only=1;this.sendDataToLog(w,y,false)};t.prototype._getDataToLogImpl=function(w){var x=this.behavior.getDataToLog(w);if(!x.ft)x.ft={};return x};t.clearSingleton=function(){};var u={getAllStories:function w(){return[]},getStoryID:function w(x){return null},getDataToLog:function w(x){return{}}},v=c("viewportTrackingBuilder")(function(w){return new t(u)});t.factory=v.factory.bind(v);t.singleton=v.singleton.bind(v);t.clearSingleton=v.clearSingleton.bind(v);t.getBehavior=function(){return u};f.exports=t}),null);
__d("collectSubtreeData",[],(function a(b,c,d,e,f,g){__p&&__p();function h(j,k,l,m,n){__p&&__p();if(j.offsetWidth===0&&j.offsetHeight===0)return n;var o={};if(j.getAttribute)for(s=0;s<k.length;s++){u=k[s];var p=j.getAttribute(l[u]);if(p){o[u]={};var q=JSON.parse(p);for(var r in m)if(q[r]!==undefined){o[u][r]=true;if(n[u]===undefined)n[u]={};if(n[u][r]===undefined)n[u][r]=[];if(m[r].length>0)n[u][r].push(m[r]);n[u][r].push("("+q[r])}}}for(var s=0;s<j.childNodes.length;s++){var t=j.childNodes[s];h(t,k,l,m,n)}for(var u in o)for(var v in o[u]){var w=n[u][v][n[u][v].length-1];if(w.length>0&&w.charAt(0)=="(")n[u][v][n[u][v].length-1]=w.substr(1);else n[u][v].push(")")}return n}function i(j,k){var l={};for(var m=0;m<k.length;++m)l[k[m]]="data-"+k[m];var n={tn:"","tn-debug":","},o={};h(j,k,l,n,o);for(var p in o)for(var q in o[p])o[p][q]=o[p][q].join("");return o}f.exports=i}),null);
__d("recordTNTreeData",["collectSubtreeData"],(function a(b,c,d,e,f,g){__p&&__p();function h(i,j){__p&&__p();var k={},l=c("collectSubtreeData")(i,["ft"]);for(var m in l.ft){k[m+"_tree"]=l.ft[m];if(m==="tn-debug")i.setAttribute("tn-debug_subtree",l.ft[m])}k.evt_value=i.offsetHeight;if(j)k.offset=Math.max(0,i.offsetTop-j.offsetTop);return k}f.exports=h}),null);
__d("PagesBrowserUtils",["Event","QE2Logger","tidyEvent"],(function a(b,c,d,e,f,g){var h="pages_browser_your_pages_tab_redesign",i="navItem_2530096808",j={init:function k(){var l=document.getElementById(i);c("tidyEvent")(c("Event").listen(l,"click",function(m){c("QE2Logger").logExposureForUser(h)}))}};f.exports=j}),null);
__d("PhotosUploadWaterfallMixin",["PhotosUploadWaterfall","emptyFunction"],(function a(b,c,d,e,f,g){var h=c("emptyFunction"),i={getUploaderApp:h,getWaterfallID:h,getAdditionalData:function j(){return{}},logWaterfallStep:function j(k,l,m){c("PhotosUploadWaterfall").sendSignal(babelHelpers["extends"]({qn:this.getWaterfallID(),uploader:this.getUploaderApp(),step:k,ref:this.getWaterfallSource&&this.getWaterfallSource()},this.getAdditionalData(),l),m)},logWaterfallStepUsingBanzai:function j(k,l,m){c("PhotosUploadWaterfall").sendBanzai(babelHelpers["extends"]({qn:this.getWaterfallID(),uploader:this.getUploaderApp(),step:k,ref:this.getWaterfallSource&&this.getWaterfallSource()},this.getAdditionalData(),l),m)}};f.exports=i}),null);
__d("PhotoSourceTypes",["keyMirror"],(function a(b,c,d,e,f,g){f.exports=c("keyMirror")({COMPUTER:null,POSTED_PHOTOS:null,SYNCED_PHOTOS:null,SUGGESTIONS:null,PAGES_POSTED_PHOTOS:null})}),null);
__d("BaseSelectionContainer",[],(function a(b,c,d,e,f,g){__p&&__p();var h=0;function i(){"use strict";this.$BaseSelectionContainer1=(h++).toString()}i.prototype.getSelectionContainerID=function(){"use strict";return this.$BaseSelectionContainer1};i.prototype.getSource=function(){"use strict";throw new Error("This must be implemented by the child class")};i.prototype.getName=function(){"use strict";return null};i.prototype.getSize=function(){"use strict";return null};i.prototype.hasPlaceholderUI=function(){"use strict";throw new Error("This must be implemented by the child class")};f.exports=i}),null);
__d("SelectionSource",["PhotoSourceTypes"],(function a(b,c,d,e,f,g){var h={FILE:"file",FLASH:"flash",VAULT:"vault",SUGGESTIONS:"suggestions",POSTED_PHOTOS:"posted_photos",PAGES_POSTED_PHOTOS:"pages_posted_photos",toPhotoSourceType:function i(j){switch(j){case h.FILE:case h.FLASH:return c("PhotoSourceTypes").COMPUTER;case h.VAULT:return c("PhotoSourceTypes").SYNCED_PHOTOS;case h.SUGGESTIONS:return c("PhotoSourceTypes").SUGGESTIONS;case h.POSTED_PHOTOS:return c("PhotoSourceTypes").POSTED_PHOTOS;case h.PAGES_POSTED_PHOTOS:return c("PhotoSourceTypes").PAGES_POSTED_PHOTOS;default:throw new Error("No mapping for SelectionSource: "+j)}}};f.exports=h}),null);
__d("FileSelectionContainer",["BaseSelectionContainer","SelectionSource"],(function a(b,c,d,e,f,g){__p&&__p();var h,i;h=babelHelpers.inherits(j,c("BaseSelectionContainer"));i=h&&h.prototype;function j(k){"use strict";i.constructor.call(this);this.$FileSelectionContainer1=k}j.prototype.getFile=function(){"use strict";return this.$FileSelectionContainer1};j.prototype.getSource=function(){"use strict";return c("SelectionSource").FILE};j.prototype.getName=function(){"use strict";return this.$FileSelectionContainer1.fileName||this.$FileSelectionContainer1.name};j.prototype.getSize=function(){"use strict";return this.$FileSelectionContainer1.fileSize||this.$FileSelectionContainer1.size};j.prototype.hasPlaceholderUI=function(){"use strict";return false};f.exports=j}),null);
__d("AlbumMediaUploadUtils",["VideoUploadConfig"],(function a(b,c,d,e,f,g){var h={isVideoFile:function i(j){var k=j.name,l=c("VideoUploadConfig").videoExtensions,m=k.indexOf(".")!==-1?k.split(".").pop().toLowerCase():"";return l[m]},hasVideos:function i(j){return this._filterVideos(j).length>0},_filterVideos:function i(j){return this._filterFileOfSupportedType(j,c("VideoUploadConfig").videoExtensions)},_filterFileOfSupportedType:function i(j,k){return j.filter(function(l){var m=l.indexOf(".")!==-1?l.split(".").pop().toLowerCase():"";return k[m]})}};f.exports=h}),null);
__d("FilePickerEvent",[],(function a(b,c,d,e,f,g){f.exports={BEGIN:"FilePickerEvent/BEGIN",SELECT_START:"FilePickerEvent/SELECT_START",SELECTED:"FilePickerEvent/SELECTED_FILES",ALBUM_LIMIT_EXCEEDED:"FilePickerEvent/ALBUM_LIMIT_EXCEEDED",SESSION_LIMIT_EXCEEDED:"FilePickerEvent/SESSION_LIMIT_EXCEEDED",SELECT_CANCELED:"FilePickerEvent/SELECT_CANCELED",FALLBACK:"FilePickerEvent/FALLBACK"}}),null);
__d("HTML5FilePicker",["cx","ArbiterMixin","BrowserSupport","CSS","DOM","FilePickerEvent","FileSelectionContainer","Keys","Parent","PhotosUploadID","PhotosUploadWaterfall","PhotosUploadWaterfallMixin","PhotosUploadWaterfallXMixin","PUWApplications","PUWSteps","URI","getOrCreateDOMID"],(function a(b,c,d,e,f,g,h){__p&&__p();function i(j,k){__p&&__p();this._config=babelHelpers["extends"]({accept:undefined,multiple:undefined},k);this._button=j;this._beginInformed=false;if(!c("BrowserSupport").hasFileAPI()){this.logStep(c("PUWSteps").CLIENT_PROCESS_UNAVAILABLE,{error:"no_file_api"});if(Object.prototype.hasOwnProperty.call(this._config,"fallbackFunction")){this._config.fallbackFunction.call(this);return}return}this._subscriptions=[];var l=this._config.input||c("DOM").create("input",{type:"file",className:"_n",tabindex:"-1"});if(Object.prototype.hasOwnProperty.call(this._config,"accept"))l.accept=this._config.accept;if(Object.prototype.hasOwnProperty.call(this._config,"multiple"))l.multiple=this._config.multiple;if(Object.prototype.hasOwnProperty.call(this._config,"title"))l.title=this._config.title;var m=c("DOM").create("label",{className:"accessible_elem","for":c("getOrCreateDOMID")(l)},l.title),n=c("DOM").create("div",{className:"_3jk"},[m,l]);c("CSS").addClass(this._button,"_m");c("DOM").appendContent(this._button,n);this._button.setAttribute("rel","ignore");this._bindInput(l);this._button.onkeydown=function(event){if(event.keyCode===c("Keys").RETURN){this._input.click();if(event&&event.stopPropagation)event.stopPropagation()}}.bind(this);var o=c("Parent").byClass(this._button,"addPhotosDisabled");if(o){c("CSS").removeClass(o,"addPhotosDisabled");c("CSS").addClass(o,"addPhotosEnabled")}}Object.assign(i.prototype,c("ArbiterMixin"),c("PhotosUploadWaterfallMixin"),c("PhotosUploadWaterfallXMixin"),{getUploaderApp:function j(){return c("PhotosUploadWaterfall").APP_HTML5},getWaterfallID:function j(){return this._config.qn},getWaterfallAppName:function j(){return c("PUWApplications").WEB_HTML5},getWaterfallSource:function j(){return this._config.ref},getSwfID:function j(){return null},_constructFileList:function j(){var k=Array.from(this._input.files);k.forEach(function(l){l.uploadID=c("PhotosUploadID").getNewID()});return k},_constructFileSelectionContainerList:function j(){var k=Array.from(this._input.files);return k.map(function(l){return new(c("FileSelectionContainer"))(l)})},cleanup:function j(){if(this._input){this._input.onclick=null;this._input.onchange=null}if(this._button)this._button.onkeydown=null},_bindInput:function j(k){__p&&__p();this.cleanup();k.onclick=function(){this.logWaterfallStep(c("PhotosUploadWaterfall").SELECT_START);if(!this._beginInformed){this._beginInformed=true;this.inform(c("FilePickerEvent").BEGIN||"FilePickerEvent/BEGIN")}this.inform(c("FilePickerEvent").SELECT_START)}.bind(this);k.onchange=function(){this.inform(c("FilePickerEvent").SELECTED,{sender:this,files:this._constructFileList(),selections:this._constructFileSelectionContainerList()});this._bindInput(this._input.cloneNode(false))}.bind(this);if(this._input)c("DOM").replace(this._input,k);this._input=k}});f.exports=i}),null);
__d("UploadSession",["invariant","AlbumMediaUploadUtils","AsyncRequest","FilePickerEvent","SubscriptionsHandler","PhotosUploadWaterfall","PUWSteps","URI"],(function a(b,c,d,e,f,g,h){__p&&__p();var i={};function j(m){"use strict";__p&&__p();this._sessionID=m;this._asyncBootstrapped=false;this._controller=null;this._overlay=null;this._pickers=[];this._pendingPhotoFileLists=[];this._pendingVideoFileLists=[];this._beginLogged=false;this._albumLimitWasExceeded=false;this._sessionLimitWasExceeded=false;this._subscriptions=new(c("SubscriptionsHandler"))()}j.prototype.addFilePicker=function(m){"use strict";__p&&__p();if(!this._pickers.includes(m)){this._pickers.push(m);if(this._controller&&m.getSwfID&&m.getSwfID())this._controller.preregisterSwf&&this._controller.preregisterSwf(m.getSwfID());this._subscriptions.addSubscriptions(m.subscribe(c("FilePickerEvent").BEGIN,function(n,o){if(!this._beginLogged){this._beginLogged=true;m.logWaterfallStep(c("PhotosUploadWaterfall").BEGIN);m.logStep(c("PUWSteps").CLIENT_FLOW_BEGIN)}}.bind(this)),m.subscribe(c("FilePickerEvent").SELECTED,function(n,o){__p&&__p();m.logStep(c("PUWSteps").CLIENT_SELECT_SUCCESS,{volume:o.files.length});var p=[],q=[];o.files.forEach(function(t){if(c("AlbumMediaUploadUtils").isVideoFile(t))p.push(t);else q.push(t)});if(this._controller){if(q.length>0)this._controller.uploadFiles(q);if(this._videoController&&p.length>0)this._videoController.uploadFiles(p)}else{if(q.length>0)this._pendingPhotoFileLists.push(q);if(p.length>0)this._pendingVideoFileLists.push(p)}if(this._asyncBootstrapped)return;var r=m._button,s=new(c("URI"))(r.getAttribute("ajaxify"));s.addQueryData("num_selected",o.files.length);c("AsyncRequest").bootstrap(s.toString(),r,true);this._asyncBootstrapped=true}.bind(this)),m.subscribe(c("FilePickerEvent").SELECT_START,function(){m.logStep(c("PUWSteps").CLIENT_SELECT_BEGIN)}.bind(this)),m.subscribe(c("FilePickerEvent").SELECT_CANCELED,function(){m.logStep(c("PUWSteps").CLIENT_SELECT_CANCEL);if(!this._overlay){m.logStep(c("PUWSteps").CLIENT_FLOW_CANCEL);this._beginLogged=false}}.bind(this)),m.subscribe(c("FilePickerEvent").ALBUM_LIMIT_EXCEEDED,function(){if(this._controller)this._controller.albumLimitExceeded();else this._albumLimitWasExceeded=true}.bind(this)),m.subscribe(c("FilePickerEvent").SESSION_LIMIT_EXCEEDED,function(){if(this._controller)this._controller.sessionLimitExceeded();else this._sessionLimitWasExceeded=true}.bind(this)))}};j.prototype.addController=function(m,n){"use strict";__p&&__p();this._controller=m;this._videoController=n;this._asyncBootstrapped=true;var o=this._controller.getWaterfallID?this._controller.getWaterfallID():this._controller.getWaterfallConfig().waterfallID,p=this._controller.getUploaderApp?this._controller.getUploaderApp():this._controller.getWaterfallConfig().waterfallApp;if(!this._beginLogged){this._beginLogged=true;c("PhotosUploadWaterfall").sendSignal({qn:o,step:c("PhotosUploadWaterfall").BEGIN,uploader:p})}if(this._pendingPhotoFileLists.length>0||this._pendingVideoFileLists.length>0){var q=[],r=[];this._pendingVideoFileLists.forEach(function(s){r=r.concat(s)});this._pendingPhotoFileLists.forEach(function(s){q=q.concat(s)});if(q.length>0)this._controller.uploadFiles(q);if(r.length>0)this._videoController.uploadFiles(r)}else c("PhotosUploadWaterfall").sendSignal({qn:o,step:c("PhotosUploadWaterfall").OVERLAY_FIRST,uploader:p});if(this._albumLimitWasExceeded)this._controller.albumLimitExceeded();if(this._sessionLimitWasExceeded)this._controller.sessionLimitExceeded()};j.prototype.addOverlay=function(m){"use strict";this._overlay=m};j.prototype.addOverlayAndController=function(m,n){"use strict";this.addOverlay(m);this.addController(n,null)};j.prototype.getFilePickers=function(){"use strict";return this._pickers};j.prototype.cleanup=function(){"use strict";this._subscriptions&&this._subscriptions.release()};j.addFilePickerToSession=function(m,n){"use strict";k(m).addFilePicker(n)};j.addControllerToSession=function(m,n,o){"use strict";k(m).addController(n,o)};j.addOverlayToSession=function(m,n){"use strict";k(m).addOverlay(n)};j.addOverlayAndControllerToSession=function(m,n,o){"use strict";k(m).addOverlayAndController(n,o)};j.restartSessionPersistingFilePickers=function(m){"use strict";var n=k(m),o=new j(m);n.getFilePickers().forEach(function(p){o.addFilePicker(p)});l(m,o)};function k(m){if(!i[m])i[m]=new j(m);return i[m]}function l(m,n){i[m]||h(0);i[m].cleanup();delete i[m];i[m]=n}f.exports=j}),null);
__d("StreamViewportTracking",["DataAttributeUtils","DOM","DOMDimensions","ViewportTracking","ge","recordTNTreeData","viewportTrackingBuilder"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h,i,j=51;function k(n,o,p){__p&&__p();var q=arguments.length<=3||arguments[3]===undefined?j:arguments[3];return{_stream:null,getDataFromConfig:function r(s,t){t.isTimetrackingEnabled=true},getAllStories:function r(){var s=c("DOM").scry(this.getStream(),p);return s.filter(function(t){return c("DataAttributeUtils").getDataFt(t)})},getStream:function r(){if(o)return o;if(!this._stream)this._stream=c("ge")("home_stream");return this._stream},getStoryID:function r(s){var t=JSON.parse(c("DataAttributeUtils").getDataFt(s));return t&&t.mf_story_key},getDataToLog:function r(s){__p&&__p();var t=this.getStream(),u=c("recordTNTreeData")(s,t),v=s.getAttribute("data-insertion-position");if(v!==null)u.inspos=v;u.evt=q;u.vpv_time=Math.round(Date.now()/1e3);var w=c("DOM").scry(s,".fbStoryAttachmentImage")[0];if(w){var x=c("DOMDimensions").getElementDimensions(w);u.story_image_height=x.height;u.story_image_width=x.width}return{ft:u}}}}h=babelHelpers.inherits(l,c("ViewportTracking"));i=h&&h.prototype;l.prototype.getQueryID=function(n){var o=JSON.parse(c("DataAttributeUtils").getDataFt(n));return o.qid};l.prototype.getFBFeedLocations=function(n){var o=JSON.parse(c("DataAttributeUtils").getDataFt(n));return o.fbfeed_location};l.prototype.getFBFeedInsertionPosition=function(n){var o=JSON.parse(c("DataAttributeUtils").getDataFt(n));return o.insertion_position};l.prototype.getTimetrackingDataToLog=function(n){__p&&__p();var o=i.getTimetrackingDataToLog.call(this,n);if(this.ctaLoggingEnabled){var p=c("DOM").scry(n.story,"[data-is-cta]").map(function(q){var r=c("DataAttributeUtils").getDataFt(q),o=r&&JSON.parse(r);return o&&o.cta_types}).filter(function(q){return!!q});if(p.length>0)o.ft.cta_types=p}return o};l.prototype.cleanup=function(){m.clearSingleton();i.cleanup.call(this)};function l(){h.apply(this,arguments)}var m=c("viewportTrackingBuilder")(function(n,o){var p=new l(k(n,o,".uiStreamStory"));p.init(n);return p});l.factory=m.factory.bind(m);l.singleton=m.singleton.bind(m);l.clearSingleton=m.clearSingleton.bind(m);l.getBehavior=k;f.exports=l}),null);
__d("FbFeedAccessible",["csx","fbt","invariant","AccessibilityConfig","Arbiter","ARIA","CSS","DataAttributeUtils","DOMQuery","LitestandMessages","SubscriptionsHandler","ge","getOrCreateDOMID"],(function a(b,c,d,e,f,g,h,i,j){__p&&__p();var k="Accessibility/StoriesRequested",l="Accessibility/StoriesLoaded",m="Accessibility/StoryContentInserted",n="Accessibility/SubstreamInserted",o=void 0,p=void 0,q={init:function r(s){o=s;if(c("AccessibilityConfig").a11yNewsfeedStoryEnumeration){var t=new(c("SubscriptionsHandler"))();t.addSubscriptions(c("Arbiter").subscribe(c("LitestandMessages").STORIES_REQUESTED,this._onStoriesRequested.bind(this)),c("Arbiter").subscribe(c("LitestandMessages").STORIES_INSERTED,this._onInsertedSubstream.bind(this)),c("Arbiter").subscribe(c("LitestandMessages").NEWER_STORIES_INSERTED,this._onInsertedSubstream.bind(this)),c("Arbiter").subscribe(l,this._processStoriesLoaded.bind(this)),c("Arbiter").subscribe(k,this._processStoriesRequested.bind(this)),c("Arbiter").subscribe(m,this._processStoryContentInserted.bind(this)),c("Arbiter").subscribe(n,this._processInsertedSubstream.bind(this)));this._enumerateStories()}},informStoryContentInserted:function r(s){c("Arbiter").inform(m,s);var t=c("ge")(s);if(t&&this._isStory(t)){this.setARIARole(t);this.setAriaLabelledBy(t);this.setAriaDescribedBy(t)}},setARIARole:function r(s){s.setAttribute("role","article")},setAriaLabelledBy:function r(s){if(s.getAttribute("aria-labelledby"))return;var t=this._filterForElement(s,["._5pbw"]);if(t.length>0)s.setAttribute("aria-labelledby",t.map(function(u){return c("getOrCreateDOMID")(u)}).join(" "))},setAriaDescribedBy:function r(s){if(s.getAttribute("aria-describedby"))return;var t=this._filterForElement(s,[".timestampContent","._5pbx"]);if(t.length>0)s.setAttribute("aria-describedby",t.map(function(u){return c("getOrCreateDOMID")(u)}).join(" "))},_getStories:function r(s){return c("DOMQuery").scry(s||o,"._5jmm")},_onInsertedSubstream:function r(s,t){if(t&&t.substream_id)c("Arbiter").inform(n,t.substream_id)},_onStoriesRequested:function r(){c("Arbiter").inform(k)},_enumerateStories:function r(){var s=this._getStories(o);p=s.length;s.forEach(function(t,u){this._enumerateStory(t,u+=1)}.bind(this))},_enumerateSubstream:function r(s){var t=this._getStories();p=t.length;var u=this._getStories(c("ge")(s)),v=u.length||0;for(var w=0;w<v;w++)this._registerStoryEnumerationPosition(u[w],p-v+(w+1),w+1)},_enumerateStory:function r(s,t){this._isStory(s)||j(0);if(t>0){s.setAttribute("aria-posinset",""+t);s.setAttribute("aria-setsize",p)}},_processStoriesLoaded:function r(){c("ARIA").notify(i._("More stories loaded."))},_processStoriesRequested:function r(){c("ARIA").notify(i._("More stories requested."))},_processInsertedSubstream:function r(s,t){this._enumerateSubstream(t);this._enumerateStories()},_processStoryContentInserted:function r(s,t){__p&&__p();var u=void 0,v=c("ge")(t);if(v)u=JSON.parse(c("DataAttributeUtils").getDataFt(v));if(u&&u.ordinal_position){var w=u.ordinal_position.split(":"),x=w[0],y=w[1];x=parseInt(x,10);y=parseInt(y,10);this._enumerateStory(v,x);if(y===1)c("Arbiter").inform(l)}},_registerStoryEnumerationPosition:function r(s,t,u){var v=JSON.parse(c("DataAttributeUtils").getDataFt(s));if(v){v.ordinal_position=t+":"+u;c("DataAttributeUtils").setDataFt(s,JSON.stringify(v))}},_isStory:function r(s){return c("CSS").matchesSelector(s,"._5jmm")},_filterForElement:function r(s,t){return t.map(function(u){return c("DOMQuery").scry(s||document,u)[0]}).filter(function(u){return!!u})}};f.exports=q}),null);
__d("FbFeedKeyboardController",["csx","cx","CSS","DOM","DOMQuery","FbFeedHighlight","FeedBaseKeyboardController","Focus","JSXDOM","Parent","ge","getActiveElement"],(function a(b,c,d,e,f,g,h,i){__p&&__p();var j,k;function l(o){if(o.previousElementSibling instanceof HTMLElement)return o.previousElementSibling;var p=o.previousSibling;while(p&&!(p instanceof HTMLElement))p=p.previousSibling;return p||null}function m(o){if(o.nextElementSibling instanceof HTMLElement)return o.nextElementSibling;var p=o.nextSibling;while(p&&!(p instanceof HTMLElement))p=p.nextSibling;return p||null}j=babelHelpers.inherits(n,c("FeedBaseKeyboardController"));k=j&&j.prototype;n.prototype.getStories=function(o){"use strict";return c("DOMQuery").scry(o||this.root,"._5jmm")};n.prototype.isHoldoutStory=function(o){"use strict";return!!o&&c("CSS").hasClass(o,"holdoutAdStory")};n.prototype.isRelevantStory=function(o){"use strict";return o instanceof HTMLElement&&!this.isHoldoutStory(o)};n.prototype.isStory=function(o){"use strict";return c("CSS").matchesSelector(o,"._5jmm")};n.prototype.clickLike=function(){"use strict";__p&&__p();var o=this.$FbFeedKeyboardController1();this.clickElement(o,".UFILikeLink");if(o!==this.selected)return;var p=this.getParentStory(c("getActiveElement")());if(p){var q=c("DOMQuery").scry(p,".UFILikeLink");for(var r=0;r<q.length;r++)if(!c("CSS").hasClass(q[r],"accessible_elem"))c("Focus").setWithoutOutline(q[r])}};n.prototype.clickComment=function(){"use strict";this.clickElement(this.$FbFeedKeyboardController1(),".comment_link")};n.prototype.clickShare=function(){"use strict";this.click(".share_action_link")};n.prototype.clickSeeMore=function(){"use strict";this.click(".see_more_link")};n.prototype.clickLeft=function(){"use strict";this.click("._1mri")};n.prototype.clickRight=function(){"use strict";this.click("._2fu-")};n.prototype.openAttachment=function(){"use strict";this.click("._5dec","a._52c6","._4-eo",".uiVideoThumb")};n.prototype.getHeadline=function(o){"use strict";return c("DOMQuery").scry(o,"h5._5pbw")[0]};n.prototype.$FbFeedKeyboardController2=function(o){"use strict";var p=c("Parent").bySelector(o,"._5pcb"),q=c("ge")("pagelet_soft_permalink_posts");return!!(p||q&&c("DOM").contains(q,o))};n.prototype.getPreviousSibling=function(o){"use strict";__p&&__p();var p=l(o);if(p&&this.getParentStory(p))return p;p=null;if(this.$FbFeedKeyboardController2(o)){var q=this.getStories(this.root),r=q.indexOf(o);while(r>-1){if(r===0){p=c("ge")("pagelet_composer");p=p&&c("Parent").bySelector(p,"._5jmm")}else if(r>0){p=q[r-1];if(p.offsetHeight>0)break}r--}}if(p instanceof HTMLElement)return p;return this.selected};n.prototype.getPreviousStory=function(o){"use strict";var p=this.getPreviousSibling(o);while(p&&!this.isStory(p))p=this.getPreviousSibling(p);return p};n.prototype.getParentStory=function(o){"use strict";var p=c("Parent").bySelector(o,"._5jmm");return p instanceof HTMLElement?p:null};n.prototype.getNextSibling=function(o){"use strict";__p&&__p();var p=m(o);if(p&&this.getParentStory(p))return p;p=null;if(this.$FbFeedKeyboardController2(o)){var q=this.getStories(this.root),r=q.indexOf(o);if(r>-1){p=q[++r];while(p&&p.offsetHeight===0)p=q[++r]}}else if(c("ge")("pagelet_composer",o))p=c("DOMQuery").scry(document,"div._5pcb ._5jmm")[0];return p||this.selected};n.prototype.getNextStory=function(o){"use strict";var p=this.getNextSibling(o);while(p&&!this.isStory(p))p=this.getNextSibling(p);return p};n.prototype.setSelected=function(o,p){"use strict";__p&&__p();if(o){var q="_5qdu",r=c("DOMQuery").scry(o,"._5qdu");if(!r.length&&p)c("DOM").prependContent(o,c("JSXDOM").div({className:q}))}if(p){this.selected&&this.setTabindexOnStory(this.selected,"-1");this.selected&&c("CSS").removeClass(this.selected,"_5qdv");this.selected=o;o&&this.setTabindexOnStory(o,"0");o&&c("CSS").addClass(o,"_5qdv");o&&c("FbFeedHighlight").highlightSingle(o)}};n.prototype.$FbFeedKeyboardController1=function(){"use strict";var o=c("DOM").scry(this.selected,"._1qch");if(o.length>0)return c("DOM").scry(this.selected,"._3el7")[0];return this.selected};n.init=function(o){"use strict";return new n(o)};function n(){"use strict";j.apply(this,arguments)}f.exports=n}),null);
__d("TimelineViewportTrackingLogType",[],(function a(b,c,d,e,f,g){f.exports=Object.freeze({IMPRESSION:"impression",DURATION:"duration"})}),null);
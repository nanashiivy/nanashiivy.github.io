if (self.CavalryLogger) { CavalryLogger.start_js(["Bx4JN"]); }

__d("FacebarResultStoreUtils",["FacebarGlobalOptions","FacebarJSConstants"],(function a(b,c,d,e,f,g){"use strict";__p&&__p();var h={getQueryFeatures:function i(j){__p&&__p();var k={};if(c("FacebarGlobalOptions").enableBootstrapRanking){if(j.raw_text)k.FEATURE_QUERY_LENGTH=j.raw_text.length;if(j.tokens){k.FEATURE_QUERY_TOKENS=j.tokens.length;k.FEATURE_QUERY_TOKEN_LENGTH_SUM=0;for(var l=0;l<j.tokens.length;l++)k.FEATURE_QUERY_TOKEN_LENGTH_SUM+=j.tokens[l].length}}return k},addFeatures:function i(j,k,l,m,n,o){__p&&__p();if(!j.features)return;j.features={FEATURE_QUERY_LENGTH:m.FEATURE_QUERY_LENGTH,FEATURE_QUERY_TOKENS:m.FEATURE_QUERY_TOKENS,FEATURE_QUERY_TOKEN_LENGTH_SUM:m.FEATURE_QUERY_TOKEN_LENGTH_SUM};j.features.FEATURE_IS_EXACT_NAME_MATCH=n;j.features.FEATURE_IS_STOP_WORD_MATCH=o;if(k&&k.length>0){var p=k.split(" ").length,q=0;for(var r=0;r<j.termMatches.length;++r)if(k.search(j.termMatches[r])>=0)q++;j.features.FEATURE_TITLE_TOKEN_MATCH_FRACTION=q/p}if(l.tokens&&l.tokens.length>0){var s=k.search(l.tokens[0]);j.features.FEATURE_FIRST_TERM_MATCH_POSITION=s;j.features.FEATURE_FIRST_TERM_MATCH_TOKEN=k.substring(0,s+l.tokens[0].length).split(" ").length;j.termMatches.some(function(t){if(t.search(l.tokens[0])===0){j.features.FEATURE_FIRST_TERM_MATCH_TOKEN_FRACTION=l.tokens[0].length/t.length;return true}return false});j.features.FEATURE_IN_ORDER_MATCH=1;if(l.tokens.length>1){s=k.search(l.tokens[1]);j.features.FEATURE_SECOND_TERM_MATCH_POSITION=s;j.features.FEATURE_SECOND_TERM_MATCH_TOKEN=k.substring(0,s+l.tokens[1].length).split(" ").length;j.termMatches.some(function(t){if(t.search(l.tokens[1])===0){j.features.FEATURE_FIRST_TERM_MATCH_TOKEN_FRACTION=l.tokens[0].length/t.length;return true}return false});if(j.features.FEATURE_SECOND_TERM_MATCH_TOKEN<j.features.FEATURE_FIRST_TERM_MATCH_POSITION)j.features.FEATURE_IN_ORDER_MATCH=0}}return j},processEntityResult:function i(j,k,l,m,n,o,p,q,r){var s={semantic:k.toString(),structure:[{type:j===c("FacebarJSConstants").keywordType?j:"ent:"+j,text:l,uid:k}],type:j,cost:m,cache_id_length:0,features:[]};s.tuid=JSON.stringify({semantic:s.semantic,structure:s.structure});if(c("FacebarGlobalOptions").enableBootstrapRanking){s.termMatches=p[k.toString()];s=this.addFeatures(s,l.toLowerCase(),n,o,q,r)}return s},getRawTextFromStructured:function i(j){var k=j.map(function(l){return l.getText()});return k.join("")},getTextFromResult:function i(j){var k=j.structure,l="";k.forEach(function(m){l+=m.text});return l}};f.exports=h}),null);
__d("getHashtagRegexString",[],(function a(b,c,d,e,f,g){function h(){var i="\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u024f\u0253-\u0254\u0256-\u0257\u0259\u025b\u0263\u0268\u026f\u0272\u0289\u028b\u02bb\u0300-\u036f\u1e00-\u1eff",j="\u0400-\u04ff\u0500-\u0527\u2de0-\u2dff\ua640-\ua69f\u0591-\u05bf\u05c1-\u05c2\u05c4-\u05c5\u05c7\u05d0-\u05ea\u05f0-\u05f4\ufb12-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4f\u0610-\u061a\u0620-\u065f\u066e-\u06d3\u06d5-\u06dc\u06de-\u06e8\u06ea-\u06ef\u06fa-\u06fc\u06ff\u0750-\u077f\u08a0\u08a2-\u08ac\u08e4-\u08fe\ufb50-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\u200c-\u200c\u0e01-\u0e3a\u0e40-\u0e4e\u1100-\u11ff\u3130-\u3185\ua960-\ua97f\uac00-\ud7af\ud7b0-\ud7ff\uffa1-\uffdc",k=String.fromCharCode,l="\u30a1-\u30fa\u30fc-\u30fe\uff66-\uff9f\uff10-\uff19\uff21-\uff3a\uff41-\uff5a\u3041-\u3096\u3099-\u309e\u3400-\u4dbf\u4e00-\u9fff"+k(173824)+"-"+k(177983)+k(177984)+"-"+k(178207)+k(194560)+"-"+k(195103)+"\u3003\u3005\u303b",m=i+j+l,n="A-Za-z\xaa\xb5\xba\xc0-\xd6\xd8-\xf6\xf8-\u0241\u0250-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ee\u037a\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03ce\u03d0-\u03f5\u03f7-\u0481\u048a-\u04ce\u04d0-\u04f9\u0500-\u050f\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f2\u0621-\u063a\u0640-\u064a\u066e-\u066f\u0671-\u06d3\u06d5\u06e5-\u06e6\u06ee-\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u076d\u0780-\u07a5\u07b1\u0904-\u0939\u093d\u0950\u0958-\u0961\u097d\u0985-\u098c\u098f-\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc-\u09dd\u09df-\u09e1\u09f0-\u09f1\u0a05-\u0a0a\u0a0f-\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32-\u0a33\u0a35-\u0a36\u0a38-\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2-\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0-\u0ae1\u0b05-\u0b0c\u0b0f-\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32-\u0b33\u0b35-\u0b39\u0b3d\u0b5c-\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99-\u0b9a\u0b9c\u0b9e-\u0b9f\u0ba3-\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c60-\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0-\u0ce1\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d28\u0d2a-\u0d39\u0d60-\u0d61\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0e01-\u0e30\u0e32-\u0e33\u0e40-\u0e46\u0e81-\u0e82\u0e84\u0e87-\u0e88\u0e8a\u0e8d\u0e94-\u0e97\u0e99-\u0e9f\u0ea1-\u0ea3\u0ea5\u0ea7\u0eaa-\u0eab\u0ead-\u0eb0\u0eb2-\u0eb3\u0ebd\u0ec0-\u0ec4\u0ec6\u0edc-\u0edd\u0f00\u0f40-\u0f47\u0f49-\u0f6a\u0f88-\u0f8b\u1000-\u1021\u1023-\u1027\u1029-\u102a\u1050-\u1055\u10a0-\u10c5\u10d0-\u10fa\u10fc\u1100-\u1159\u115f-\u11a2\u11a8-\u11f9\u1200-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u1676\u1681-\u169a\u16a0-\u16ea\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1780-\u17b3\u17d7\u17dc\u1820-\u1877\u1880-\u18a8\u1900-\u191c\u1950-\u196d\u1970-\u1974\u1980-\u19a9\u19c1-\u19c7\u1a00-\u1a16\u1d00-\u1dbf\u1e00-\u1e9b\u1ea0-\u1ef9\u1f00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u2094\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2131\u2133-\u2139\u213c-\u213f\u2145-\u2149\u2c00-\u2c2e\u2c30-\u2c5e\u2c80-\u2ce4\u2d00-\u2d25\u2d30-\u2d65\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u3005-\u3006\u3031-\u3035\u303b-\u303c\u3041-\u3096\u309d-\u309f\u30a1-\u30fa\u30fc-\u30ff\u3105-\u312c\u3131-\u318e\u31a0-\u31b7\u31f0-\u31ff\u3400-\u4db5\u4e00-\u9fbb\ua000-\ua48c\ua800-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\uac00-\ud7a3\uf900-\ufa2d\ufa30-\ufa6a\ufa70-\ufad9\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uff66-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc",o="\u0300-\u036f\u0483-\u0486\u0591-\u05b9\u05bb-\u05bd\u05bf\u05c1-\u05c2\u05c4-\u05c5\u05c7\u0610-\u0615\u064b-\u065e\u0670\u06d6-\u06dc\u06df-\u06e4\u06e7-\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u0901-\u0903\u093c\u093e-\u094d\u0951-\u0954\u0962-\u0963\u0981-\u0983\u09bc\u09be-\u09c4\u09c7-\u09c8\u09cb-\u09cd\u09d7\u09e2-\u09e3\u0a01-\u0a03\u0a3c\u0a3e-\u0a42\u0a47-\u0a48\u0a4b-\u0a4d\u0a70-\u0a71\u0a81-\u0a83\u0abc\u0abe-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ae2-\u0ae3\u0b01-\u0b03\u0b3c\u0b3e-\u0b43\u0b47-\u0b48\u0b4b-\u0b4d\u0b56-\u0b57\u0b82\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd7\u0c01-\u0c03\u0c3e-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55-\u0c56\u0c82-\u0c83\u0cbc\u0cbe-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5-\u0cd6\u0d02-\u0d03\u0d3e-\u0d43\u0d46-\u0d48\u0d4a-\u0d4d\u0d57\u0d82-\u0d83\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0df2-\u0df3\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb-\u0ebc\u0ec8-\u0ecd\u0f18-\u0f19\u0f35\u0f37\u0f39\u0f3e-\u0f3f\u0f71-\u0f84\u0f86-\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102c-\u1032\u1036-\u1039\u1056-\u1059\u135f\u1712-\u1714\u1732-\u1734\u1752-\u1753\u1772-\u1773\u17b6-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u192b\u1930-\u193b\u19b0-\u19c0\u19c8-\u19c9\u1a17-\u1a1b\u1dc0-\u1dc3\u20d0-\u20dc\u20e1\u20e5-\u20eb\u302a-\u302f\u3099-\u309a\ua802\ua806\ua80b\ua823-\ua827\ufb1e\ufe00-\ufe0f\ufe20-\ufe23",p="0-9\u0660-\u0669\u06f0-\u06f9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u17e0-\u17e9\u1810-\u1819\u1946-\u194f\u19d0-\u19d9\uff10-\uff19",q=n+o+m,r=p+"_",s=q+r,t="["+q+"]",u="["+s+"]",v="^|$|[^&/"+s+"]",w="[#\\uFF03]",x="("+v+")("+w+")("+u+"*"+t+u+"*)";return x}f.exports=h}),null);
__d("getHashtagRegex",["getHashtagRegexString"],(function a(b,c,d,e,f,g){function h(){return new RegExp(c("getHashtagRegexString")(),"ig")}f.exports=h}),null);
__d("HashtagParser",["URLMatcher","getHashtagRegex"],(function a(b,c,d,e,f,g){__p&&__p();var h=100,i=30,j=/@\[([0-9]+):([0-9]+):((?:[^\\\]]*(?:\\.)*)*)\]/g;function k(C){__p&&__p();var D=x(C),E=0,F=0;return m(C).map(function(G){while(E<D.length){var H=D[E],I=H.offset-F;if(I<G.offset){F+=H.token.length-H.name.length;E++}else break}return{marker:G.marker,tag:G.hashtag,rawOffset:G.offset+F,offset:G.offset}})}function l(C){return n(C,s(C))}function m(C){var D=z(C);return n(D,o(C,D))}function n(C,D){return q(C).slice(0,i).filter(function(E){var F=u(E.offset,E.hashtag.length,D);return!F&&E.hashtag.length<=h})}function o(C,D){return t(r(C),s(D))}var p=c("getHashtagRegex")();function q(C){var D=[];C.replace(p,function(E,F,G,H,I){D.push({marker:G,hashtag:H,offset:I+F.length})});return D}function r(C){return A(C).map(function(D){return[D.offset,D.name.length]})}function s(C){var D=[],E,F=0;while(E=c("URLMatcher").permissiveMatch(C)){var G=C.indexOf(E);D.push([F+G,E.length]);C=C.substring(G+E.length);F+=G+E.length}return D}function t(C,D){var E=[],F=0,G=0,H=0;while(F<C.length&&G<D.length)if(C[F][0]>D[G][0])E[H++]=D[G++];else E[H++]=C[F++];return E.concat(C.slice(F),D.slice(G))}function u(C,D,E){if(!E)return false;var F=w(E,C);return v(C,D,E,F)||v(C,D,E,F+1)}function v(C,D,E,F){if(!E[F])return false;var G=E[F][0],H=E[F][1];return!(C+D-1<G||C>G+H-1)}function w(C,D){__p&&__p();var E=0,F=C.length-1;while(E<=F){var G=Math.floor((E+F)/2),H=C[G][0];if(H==D)return G;else if(H<D)E=G+1;else F=G-1}return F}function x(C){var D=[];C.replace(j,function(E,F,G,H,I){D.push({token:E,id:F,type:G,name:H,offset:I})});return D}function y(C){return C?C.replace(/\\([^\\])/g,"$1").replace(/\\\\/g,"\\"):null}function z(C){return C.replace(j,function(D,E,F,G,H){return y(G)})}function A(C){var D=0,E=0;return x(C).map(function(F){var G=C.indexOf(F.token,E);E=G+1;G-=D;var H=y(F.name);D+=F.token.length-H.length;if(G>=0)return{id:F.id,name:H,type:F.type,offset:G}})}var B={};B.parse=k;B.parseWithoutMentions=l;f.exports=B}),null);
__d("HashtagSearchResultUtils",["fbt","FacebarResultStoreUtils","HashtagParser","HashtagSearchResultConfig","URI"],(function a(b,c,d,e,f,g,h){__p&&__p();var i={getHashtagFromQuery:function j(k){var l=c("HashtagParser").parse(k);if(l&&l.length===1&&l[0].offset===0)return l[0].tag;return false},makeTypeaheadResult:function j(k){var l=h._("Hashtag");return{category:l,path:new(c("URI"))("/hashtag/"+k).toString(),photo:c("HashtagSearchResultConfig").image_url,rankType:null,replace_results:c("HashtagSearchResultConfig").boost_result?true:false,scaled_score:1,score:0,text:"#"+k,type:"hashtag_exact",uid:"hashtag:"+k}},makeFacebarEntry:function j(k){var l=h._("Hashtag");return{category:l,path:new(c("URI"))("/hashtag/"+k).toString(),photo:c("HashtagSearchResultConfig").image_url,replace_results:c("HashtagSearchResultConfig").boost_result?true:false,text:"#"+k,type:"hashtag_exact",uid:"hashtag:"+k}},makeFacebarResult:function j(k){var l=c("FacebarResultStoreUtils").processEntityResult("hashtag_exact","hashtag:"+k,"#"+k,c("HashtagSearchResultConfig").hashtag_cost);l.parse={display:[{type:"ent:hashtag_exact",uid:"hashtag:"+k}],remTokens:[],suffix:""};l.tags={hashtag:"hashtag"};return l}};f.exports=i}),null);
__d("QueryHistory",[],(function a(b,c,d,e,f,g){var h={},i={set:function j(k,l){h[this._key(k)]=l},get:function j(k){return h[this._key(k)]},_key:function j(k){return"uri-"+k.getQualifiedURI().toString()}};f.exports=i}),null);
__d("SearchBootstrapCache",["AsyncRequest","AsyncResponse","CacheStorage","SearchBootstrapCacheConstants"],(function a(b,c,d,e,f,g){__p&&__p();var h=1,i={get:function j(k,l,m,n,o){var p=this.getKey(k,l,m),q=this.getStorage(),r=q.get(p),s=c("SearchBootstrapCacheConstants")[l.type]||36e5;if(r==null||Date.now()-r.timestamp>s)o(m,k,l);else{var t=new(c("AsyncRequest"))();t.getData=function(){return r.requestData};var u=new(c("AsyncResponse"))(t,r.payload);n(u,l)}},set:function j(k,l,m){var n=k.getRequest().getData();this.getStorage().set(this.getKey(n,l,m),{timestamp:Date.now(),payload:k.payload,requestData:n})},getKey:function j(k,l,m){return JSON.stringify({filter:k.filter,context:k.context,viewer:k.viewer,lazy:k.lazy,token:k.token,type:l.type,bootstrapEndpoint:m})},getStorage:function j(){return new(c("CacheStorage"))("localstorage","_SearchBootstrapCache_"+h)}};f.exports=i}),null);
__d("SearchSingleState",["fbt"],(function a(b,c,d,e,f,g,h){__p&&__p();function i(k,l,m,n){return{classNames:"grammar",groupIndex:0,indexInGroup:k,path:l,text:m,type:"grammar",uid:n}}var j={getSuggestions:function k(l,m,n){if(n==="ent:user")return this.getSuggestionsForUser(l,m);else if(n==="ent:page")return this.getSuggestionsForPage(l,m);else if(n==="ent:app")return this.getSuggestionsForApp(l,m);else if(n==="ent:group")return this.getSuggestionsForGroup(l,m)},getSuggestionsForUser:function k(l,m){return[i(0,"/search/"+l+"/photos-of",h._("photos of {full name}",[h.param("full name",m)]),"photos_of_user"),i(1,"/search/"+l+"/friends",h._("friends of {full name}",[h.param("full name",m)]),"friends_of_user"),i(2,"/search/"+l+"/pages-liked",h._("favorite pages of {full name}",[h.param("full name",m)]),"pages_liked_user"),i(3,"/search/str/"+m+"/users-named",h._("find all people named \"{full name}\"",[h.param("full name",m)]),"people_named_text")]},getSuggestionsForPage:function k(l,m){return[i(0,"/search/"+l+"/photos-of",h._("photos of {name of page}",[h.param("name of page",m)]),"photos_of_page"),i(1,"/search/"+l+"/likers",h._("people who like {name of page}",[h.param("name of page",m)]),"page_likers"),i(2,"/search/str/"+m+"/pages-named",h._("find all pages named \"{name of page}\"",[h.param("name of page",m)]),"pages_named_text")]},getSuggestionsForGroup:function k(l,m){return[i(0,"/search/"+l+"/members",h._("{name of group} members",[h.param("name of group",m)]),"members_of_group"),i(1,"/search/"+l+"/photos-in",h._("photos in {name of groups}",[h.param("name of groups",m)]),"photos_in_group"),i(2,"/search/"+l+"/creators",h._("{name of group} creators",[h.param("name of group",m)]),"creators_of_group"),i(3,"/search/"+l+"/admins",h._("{name of group} administrators",[h.param("name of group",m)]),"admins_of_group")]},getSuggestionsForApp:function k(l,m){return[i(0,"/search/"+l+"/apps-similar-to",h._("apps similar to {name of app}",[h.param("name of app",m)]),"similar_apps"),i(1,"/search/"+l+"/app-users",h._("people who use {name of app}",[h.param("name of app",m)]),"app_users"),i(2,"/search/str/"+m+"/pages-named",h._("find all apps named \"{name of page}\"",[h.param("name of page",m)]),"apps_named_text")]}};f.exports=j}),null);
__d("SearchDataSource",["errorCode","Arbiter","AsyncResponse","CSRFGuard","CurrentUserInitialData","DataSource","Event","FacebarJSConstants","HashtagSearchResultUtils","Map","PageTransitionsRegistrar","SearchBootstrapCache","SearchRegion","SearchSingleState","UnicodeCJK","XHRRequest","createArrayFromMixed","debounce"],(function a(b,c,d,e,f,g,h){__p&&__p();var i,j,k=100,l="/typeahead/search/facebar/nullstate/";i=babelHelpers.inherits(m,c("DataSource"));j=i&&i.prototype;function m(n){"use strict";__p&&__p();n.headerflags=new(c("Map"))();if(c("SearchRegion").sgp_fork_ss_at_proxygen||c("SearchRegion").sgp_fork_gs_at_proxygen)n.headerflags.set("X-FB-ForkingType","edge-sgp-search");j.constructor.call(this,n);this._updateMaxResults=function(){var p=window.innerHeight||document.documentElement.clientHeight;this.setMaxResults(Math.max(this._numResults.min,Math.min(this._numResults.max,Math.ceil(2+(p-370)/56))))}.bind(this);this._token=n.token||"";this._lazyonload=n.lazyonload===false?false:true;this._extraTypes=n.extraTypes;this._buckets=n.buckets;this._noMultiFetch=n.noMultiFetch||false;this._nullStateConfig=n.nullStateConfig||{};var o=n.maxResults||8;this._numResults={min:3,max:o};this.recordingRoute=n.recordingRoute||"non_banzai";this._enabledHashtag=n.enabledHashtag||false;this.logBackendQueriesWindow=n.logBackendQueriesWindow||25;this._genTime=n.genTime;this._bootstrapError=false;this._hasKeywordBootstrap=n.hasKeywordBootstrap||false;this._addJoinedTermsMatching=n.addJoinedTermsMatching||false;this._useBootstrapCache=n.useBootstrapCache||false;this._useBrowserCache=n.useBrowserCache||false;this.cacheUnicodeMatch.setConfigs({prefix_hangul_conjoining_jamo:true,prefix_kana_drop_trailing_latin:n.cjkDropLatinInCjTokens,prefix_kana_hiragana_to_katakana:n.cjkUiCacheHiraganaToKatakana,search_i18n_prefix_arabic_normalization:n.arabicNormalization});this.backendUnicodeMatch.setConfigs({prefix_kana_drop_trailing_latin:n.cjkDropLatinInCjTokens})}m.prototype.init=function(){"use strict";__p&&__p();j.init.call(this);this._leanPayload=null;this._bootstrapRequestsPending=0;this._criticalOnly=true;this._updateMaxResults();var n=c("debounce")(this._updateMaxResults,k,this,true);c("Event").listen(window,"resize",n);if(this._nullStateConfig.prefetchNullState)this.fetchNullState("");if(this._nullStateConfig.singleState)c("Arbiter").subscribe("page_transition",this.handlePageTransition.bind(this));if(this._nullStateConfig.prefetchNullState||this._nullStateConfig.singleState)c("Arbiter").subscribe("search/updateNullState",this.updateNullState.bind(this));if(this._nullStateConfig.recent)c("Arbiter").subscribe("search/refreshRecentSearchesNullstate",this.refreshRecentSearches.bind(this))};m.prototype.refreshRecentSearches=function(){"use strict";this.nullStateData=null};m.prototype.handlePageTransition=function(){"use strict";this.nullStateParams={}};m.prototype.updateNullState=function(event,n){"use strict";this.nullStateParams=n;this.fetchNullState()};m.prototype.markResultsAsNullState=function(n){"use strict";__p&&__p();if(n)for(var o=n,p=Array.isArray(o),q=0,o=p?o:o[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var r;if(p){if(q>=o.length)break;r=o[q++]}else{q=o.next();if(q.done)break;r=q.value}var s=r;s.isNullState=true}};m.prototype.markResultsAsSingleState=function(n){"use strict";__p&&__p();if(n)for(var o=n,p=Array.isArray(o),q=0,o=p?o:o[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var r;if(p){if(q>=o.length)break;r=o[q++]}else{q=o.next();if(q.done)break;r=q.value}var s=r;s.isSingleState=true}};m.prototype.fetchNullState=function(n){"use strict";__p&&__p();this.lastNullOrSingleStateFetchStartTime=Date.now();if(!this._nullStateConfig.hasNullState)return;var o=null;if(this.nullStateParams&&this.nullStateParams.uid){this.nullStateParams.query=n||"";o=this._fetchDataForSingleState();this.markResultsAsNullState(o)}else{o=this._fetchDataForNullState();this.markResultsAsSingleState(o)}if(o)this.inform("respond",{value:this.nullStateParams?this.nullStateParams.query:"",results:o,isAsync:false,nullState:true})};m.prototype._fetchDataForSingleState=function(){"use strict";__p&&__p();if(this.nullStateDataWithProfile&&this.nullStateParams.uid===this.nullStateDataWithProfile.profileID)return this.nullStateDataWithProfile.data;if(this.nullStateParams.type==="ent:app"||this.nullStateParams.type==="ent:group"||this.nullStateParams.type==="ent:page"){this.fetch(l,{profile_id:this.nullStateParams.uid,ent_type:this.nullStateParams.type},{singleState:true});this.nullStateDataWithProfile={profileID:this.nullStateParams.uid};return}var n=c("SearchSingleState").getSuggestions(this.nullStateParams.uid,this.nullStateParams.text,this.nullStateParams.type);if(!n)return this._fetchDataForNullState();this.nullStateDataWithProfile={data:n,profileID:this.nullStateParams.uid};return n};m.prototype._shouldRefreshNullState=function(){"use strict";if(!this._nullStateConfig.recent)return false;var n=window.location.href;if(!n)return false;if(n.contains("allactivity")&&n.contains("log_filter=search"))return true;return false};m.prototype._fetchDataForNullState=function(){"use strict";__p&&__p();if(this.nullStateData&&!this._shouldRefreshNullState()){this.markResultsAsNullState(this.nullStateData);setTimeout(function(){this.inform("respond",{value:"",results:this.nullStateData,isAsync:true,nullState:true})}.bind(this),0);return}if(!this.fetchingNullState){this.fetchingNullState=true;this.fetch(l,{value:""},{nullState:true,value:""})}return null};m.prototype.dirty=function(){"use strict";j.dirty.call(this);this._bootstrapError=false;this._fetchOnUseRequests=[]};m.prototype.asyncErrorHandler=function(n,o){"use strict";if(o.nullState)this.fetchingNullState=false;if(o.bootstrap)this._bootstrapError=true;this.inform("fetchError",{response:n,fetch_context:o})};m.prototype.fetch=function(n,o,p){"use strict";p=p||{};p.fetch_start=Date.now();var q=c("PageTransitionsRegistrar").getMostRecentURI().path;o=babelHelpers["extends"]({},o,{path:q});j.fetch.call(this,n,o,p)};m.prototype.xhrFetchHandler=function(n,o,p){"use strict";n=c("CSRFGuard").clean(n);var q=JSON.parse(n);return this.fetchHandler(new(c("AsyncResponse"))(null,q.payload),p,o)};m.prototype.fetchHandler=function(n,o){__p&&__p();var p=arguments.length<=2||arguments[2]===undefined?null:arguments[2];"use strict";if(o.nullState){this.fetchingNullState=false;this.nullStateData=n.getPayload().entries;this.markResultsAsNullState(this.nullStateData);this.inform("respond",{value:"",results:this.nullStateData,isAsync:true,nullState:true});return}if(o.singleState){this.nullStateDataWithProfile.data=n.getPayload().entries;this.markResultsAsSingleState(this.nullStateDataWithProfile.data);this.inform("respond",{results:this.nullStateDataWithProfile.data,isAsync:true,value:this.nullStateParams?this.nullStateParams.query:"",nullState:true});return}var q=n.getPayload(),r=babelHelpers["extends"]({fetch_end:Date.now()},o),s=r.value?c("Arbiter").BEHAVIOR_EVENT:c("Arbiter").BEHAVIOR_PERSISTENT;this.inform("beginFetchHandler",{response:n});if(o.bootstrap)this._bootstrapError=false;var t=p===null?n.getRequest().uri.getPath():p.getURI().getPath();if(t===this.bootstrapEndpoint&&this._useBootstrapCache)c("SearchBootstrapCache").set(n,o,this.bootstrapEndpoint);if(o.type=="lean"){this._leanPayload=q;this._processLean()}else{if(q.coeff2_ts)r.coeff2_ts=q.coeff2_ts;j.fetchHandler.call(this,n,o);var u=p===null?n.getRequest().getData():p.getData();if(o.bootstrap&&!u.no_cache)r.browserCacheHit=q.timestamp<this._genTime;if(o.bootstrap&&!q.no_data&&this._bootstrapRequestsPending>0){o.bootstrap=false;--this._bootstrapRequestsPending;!this._bootstrapRequestsPending&&this._bootstrapPostProcess()}if(q.no_data||q.stale||q.token!==this._token){var v=babelHelpers["extends"]({},u);if(v.lazy){delete v.lazy;v.token=this._token;this._fetchOnUse(v,o)}}}this.inform("endpointStats",{info:r,response:n},s);if(o&&!!o.value)this.inform("completeFetch",{response:n,stats:r});var w=this.getResponseHeaderValue("X-FB-ForkingPoolID");if(w.length>0)this.inform("logProxygenForkPoolId",{field:"fork_pool_id",value:w})};m.prototype.respond=function(n,o,p){"use strict";this.inform("respondValidUids",o);this.inform("reorderResults",o);var q=this.buildData(o,n);q.forEach(function(r,s){r.origIndex=s;r.fromCache=!p});this.inform("respond",{value:n,results:q,isAsync:!!p});return q};m.prototype.buildData=function(n,o){"use strict";if(!n||n.length===0)return[];var p=n.map(this.getEntry,this);p.length=Math.min(p.length,this._maxResults);return p};m.prototype.fetchLean=function(){"use strict";this._fetchLean()};m.prototype._isQueryTooShort=function(n){"use strict";return n.length<this._minQueryLength&&!this._performShortQuery&&!c("UnicodeCJK").hasIdeoOrSyll(n)};m.prototype.shouldFetchMoreResults=function(n){"use strict";return n.length<this._maxResults};m.prototype._bootstrapPostProcess=function(){"use strict";var n=0;for(var o in this._data)if(Object.prototype.hasOwnProperty.call(this._data,o))n++;this.inform("bootstrapped",{time:Date.now(),size:n},c("Arbiter").BEHAVIOR_PERSISTENT);this._processLean()};m.prototype._processLean=function(){"use strict";__p&&__p();if(this._leanPayload){var n,o=this._leanPayload.entries;for(var p in o){n=this.getEntry(p);if(n)n.index=o[p]}this.setExclusions(this._leanPayload.blocked);this._leanPayload=null}};m.prototype._bootstrapFetch=function(n,o){"use strict";var p=babelHelpers["extends"]({},o,this.bootstrapData);if(this._criticalOnly&&this._lazyonload)p.lazy=1;var q={bootstrap:true,type:n};this._fetchBootstrapMaybeCache(p,q);++this._bootstrapRequestsPending};m.prototype._fetchBootstrapMaybeCache=function(n,o){__p&&__p();var p,q=this;"use strict";if(this._useBootstrapCache)c("SearchBootstrapCache").get(n,o,this.bootstrapEndpoint,this.fetchHandler.bind(this),this.fetch.bind(this));else if(this._useBrowserCache)(function(){var r=new(c("XHRRequest"))(q.bootstrapEndpoint).setData(babelHelpers["extends"]({},n,{__user:c("CurrentUserInitialData").USER_ID,__a:1})).setMethod("GET").setResponseHandler(function(s){return this.xhrFetchHandler(s,r,o||{})}.bind(q)).setErrorHandler(function(s){return this.asyncErrorHandler(s,o)}.bind(q));q.inform("beforeFetch",{request:r,fetch_context:o});r.send()})();else this.fetch(this.bootstrapEndpoint,n,o)};m.prototype._fetchOnUse=function(n,o){"use strict";for(var p in this.bootstrapData)!Object.prototype.hasOwnProperty.call(n,p)&&(n[p]=this.bootstrapData[p]);if(this._criticalOnly)this._fetchOnUseRequests.push({args:n,ctx:o});else this._fetchBootstrapMaybeCache(n,o)};m.prototype._fetchLean=function(){"use strict";var n={no_cache:1};n.options=c("createArrayFromMixed")(n.options);n.options.push("lean");this._fetchOnUse(n,{type:"lean"})};m.prototype.bootstrap=function(n){"use strict";__p&&__p();if(!n){this._criticalOnly=false;this._flushFetchOnUseRequests()}if(this._bootstrapped)return;var o={filter:["event"]};this._fetchOnUse(o,{type:"event"});var p=["app","page","group","friendlist"];p=p.concat(this._extraTypes||[]);var q=[];if(this._hasKeywordBootstrap)q.push(c("FacebarJSConstants").keywordType);if(this._noMultiFetch){p.push("user");p=p.concat(q);this._bootstrapFetch("user",{filter:p})}else{this._bootstrapFetch("other",{filter:p});if(this._buckets)for(var r=0;r<this._buckets.length;++r){var s={filter:["user"],buckets:this._buckets[r]};this._bootstrapFetch("user",s)}else this._bootstrapFetch("user",{filter:["user"]});if(q.length>0)this._bootstrapFetch("keyword",{filter:q})}this._fetchLean();this._bootstrapped=true};m.prototype.getBootstrapError=function(){"use strict";return this._bootstrapError};m.prototype._flushFetchOnUseRequests=function(){"use strict";var n=this._fetchOnUseRequests.length;for(var o=0;o<n;++o){var p=this._fetchOnUseRequests[o];this._fetchBootstrapMaybeCache(p.args,p.ctx)}if(n>0)this.inform("extra_bootstrap",{time:Date.now()},c("Arbiter").BEHAVIOR_PERSISTENT);this._fetchOnUseRequests=[]};m.prototype.onLoad=function(n,o){"use strict";this.inform("onload",{time:Date.now()},c("Arbiter").BEHAVIOR_PERSISTENT);if(n)setTimeout(this.bootstrap.bind(this,o),0)};m.prototype.mergeUids=function(n,o,p,q){"use strict";__p&&__p();var r=this.getDynamicHashtagResult(q);if(q&&r&&o.indexOf(r)<=0)o.unshift(r);var s=p[0]?this.getEntry(p[0]):null,t=o[0]?this.getEntry(o[0]):null,u=s&&s.replace_results?s:null;u=!u&&t&&t.replace_results?t:u;var v=j.mergeUids.call(this,n,o,p,q);if(u){this.inform("backend_topreplace",{});return this.deduplicateByKey([u.uid].concat(v))}return v};m.prototype.getTextToIndexFromFields=function(n,o){"use strict";__p&&__p();var p=[],q=n.tokenVersion==="v2";for(var r=0;r<o.length;++r){if(q&&(o[r]==="text"||o[r]==="alias"))continue;var s=n[o[r]];if(s){s=s.join?s.join(" "):s;p.push(s);if(o[r]=="text"&&this._addJoinedTermsMatching){s=s.toLowerCase();s=s.replace(/ /g,"");p.push(s)}}}return p.join(" ")};m.prototype.getDynamicHashtagResult=function(n){"use strict";__p&&__p();if(!n||!this._enabledHashtag)return;var o=c("HashtagSearchResultUtils").getHashtagFromQuery(n);if(!o)return;var p="hashtag:"+o,q=this.getEntry(p);if(!q)this.processEntries([c("HashtagSearchResultUtils").makeTypeaheadResult(o)],n);return p};m.prototype.tokenizeCache=function(n,o){"use strict";n=this.cacheUnicodeMatch.prefixMatchPrepare(n);var p=this._tokenize(n,o),q=p.tokens;if(q.length>0&&p.value.startsWith("@"))q[0]="@"+q[0];return p};f.exports=m}),null);
__d("SearchPeopleFriendsOf",["fbt","TokenizeUtil","URI"],(function a(b,c,d,e,f,g,h){__p&&__p();function i(j,k){"use strict";this.friendsOfUri=j;this.placementStrategy=k.placement_strategy;this.placementParams=k.placement_params;this.triggerStrategy=k.trigger_strategy;this.triggerParams=k.trigger_params}i.prototype.injectInto=function(j,k){"use strict";if(!j||j.length===0||!this.$SearchPeopleFriendsOf1(j,k))return;if(j[0].type!=="user")return;var l=this.createFindAllFriendsOf(j[0].text,j[0].uid);this.$SearchPeopleFriendsOf2(l,j)};i.prototype.$SearchPeopleFriendsOf2=function(j,k){"use strict";var l=this.$SearchPeopleFriendsOf3(k);if(l==="last"){var m=k.filter(function(n){return n.type==="user"}).length;l=m}k.splice(l,0,j)};i.prototype.$SearchPeopleFriendsOf1=function(j,k){"use strict";var l=this.$SearchPeopleFriendsOf4(this.triggerStrategy);return l(j,this.triggerParams,k)};i.prototype.$SearchPeopleFriendsOf3=function(j){"use strict";var k=this.$SearchPeopleFriendsOf4(this.placementStrategy);return k(j,this.placementParams)};i.prototype.$SearchPeopleFriendsOf4=function(j){"use strict";return this["$SearchPeopleFriendsOf_"+j]};i.prototype.$SearchPeopleFriendsOf5=function(j,k,l){"use strict";return false};i.prototype.$SearchPeopleFriendsOf6=function(j,k,l){"use strict";return true};i.prototype.$SearchPeopleFriendsOf7=function(j,k,l){"use strict";__p&&__p();var m=parseInt(k,10),n=0;for(var o=0;o<j.length;o++){var p=j[o];if(p.type==="user"&&p.index_rank==-1)n++;if(n>m)return false}return true};i.prototype.$SearchPeopleFriendsOf8=function(j,k,l){"use strict";__p&&__p();var m=parseInt(k,10),n=c("TokenizeUtil").tokenize(l);n=n.map(function(v){return v.toLowerCase()});var o=0;for(var p=0;p<j.length;p++){var q=j[p];if(q.type!=="user"||q.index_rank!=-1)continue;var r=c("TokenizeUtil").tokenize(q.text);r=r.map(function(v){return v.toLowerCase()});if(r.length<n.length)continue;var s=true;for(var t=0;t<n.length-1;t++)if(n[t]!==r[t]){s=false;break}var u=n.length-1;if(s&&r[u].startsWith(n[u])){o++;if(o>=m)return false}}return true};i.prototype.$SearchPeopleFriendsOf9=function(j,k){"use strict";return"last"};i.prototype.$SearchPeopleFriendsOf10=function(j,k){"use strict";return 1};i.prototype.createFindAllFriendsOf=function(j,k){"use strict";var l=h._("{name}'s Friends",[h.param("name",j)]),m=new(c("URI"))(this.friendsOfUri).addQueryData({q:"",init:"psm",fofid:k}).toString();return{uid:"people_search",type:"user",text:l,classNames:"seeAllUser",photo:"/images/search_typeahead/people_see_more.png",logType:"grammar",path:m}};f.exports=i}),null);
__d("SearchPeopleSeeMore",["fbt","invariant","TokenizeUtil","URI"],(function a(b,c,d,e,f,g,h,i){__p&&__p();function j(k,l){var m=l.placement,n=l.strategy,o=l.min_users,p=l.query_to_show;"use strict";this.seeMoreUri=k;this.placement=m;this.strategy=n;this.min_users=o;this.query_to_show=p}j.prototype.injectInto=function(k,l){"use strict";if(!k||k.length===0)return;var m=this.$SearchPeopleSeeMore1(k,l);if(!m)return;var n=this.createFindAllPeopleResult(m);this.$SearchPeopleSeeMore2(n,k)};j.prototype.$SearchPeopleSeeMore1=function(k,l){"use strict";__p&&__p();if(this.strategy==="disabled")return null;if(k[0].type!=="user")return null;var m=k.filter(function(q){return q.type==="user"});if(m.length<this.min_users)return null;else if(m.length>this.min_users)m=m.slice(0,this.min_users);var n,o=m[0];switch(this.strategy){case"all_identical":var p=m.every(function(q){return this.$SearchPeopleSeeMore3(o.text,q.text)}.bind(this));n=p?o.text:null;break;case"top_results_prefix":n=m.reduce(function(n,q){return this.$SearchPeopleSeeMore4(n,q.text)}.bind(this),o.text);break;default:i(0)}if(!n)return null;return this.query_to_show==="common"?n:l};j.prototype.$SearchPeopleSeeMore2=function(k,l){"use strict";if(this.placement==="last"){var m=l.filter(function(o){return o.type==="user"}).length;l.splice(m,0,k)}else{var n=parseInt(this.placement,10);l.splice(n,0,k)}};j.prototype.createFindAllPeopleResult=function(k){"use strict";var l=h._("Find all people named \"{query}\"",[h.param("query",k.toLowerCase())]),m=new(c("URI"))(this.seeMoreUri).addQueryData({q:k,init:"psm"}).toString();return{uid:"people_search",type:"user",text:l,classNames:"seeAllUser",photo:"/images/search_typeahead/people_see_more.png",path:m}};j.prototype.$SearchPeopleSeeMore3=function(k,l){"use strict";if(k===l)return true;var m=c("TokenizeUtil").tokenize(k),n=c("TokenizeUtil").tokenize(l);if(m.length!==n.length)return false;return m.every(function(o,p){return o===n[p]})};j.prototype.$SearchPeopleSeeMore4=function(k,l){"use strict";__p&&__p();if(!k||!l)return;if(k===l)return k;var m=c("TokenizeUtil").tokenize(k),n=c("TokenizeUtil").tokenize(l),o=[];for(var p=0;p<m.length&&p<n.length;p++)if(m[p]===n[p])o.push(m[p]);else break;if(o.length===0)return null;return o.join(" ")};f.exports=j}),null);
__d("SearchTypeaheadCore",["Arbiter","DOM","Event","Input","Keys","Parent","ScriptPath","TypeaheadCore"],(function a(b,c,d,e,f,g){__p&&__p();var h,i;h=babelHelpers.inherits(j,c("TypeaheadCore"));i=h&&h.prototype;function j(k){"use strict";i.constructor.call(this,k)}j.prototype.init=function(k,l,m){"use strict";__p&&__p();i.init.call(this,k,l,m);var n=c("Parent").byTag(m,"form"),o=this.reset.bind(this);c("Arbiter").subscribe("pre_page_transition",function(event,q){var r=/^\/search/,s=r.test(q.from.path),t=r.test(q.to.path);if(s&&!t)setTimeout(o,0)});if(n){var p=c("DOM").find(n,"input.search_sid_input");c("Event").listen(n,"submit",function(){if(this.data&&this.data.queryData)p.value=this.data.queryData.sid;setTimeout(o,0)}.bind(this),c("Event").Priority.URGENT)}};j.prototype.select=function(){"use strict";this.reset();this.element.focus();setTimeout(function(){this.element.blur()}.bind(this),0);c("ScriptPath").setClickPointInfo({click:"Search"})};j.prototype.handleTab=function(event){"use strict";var k=this.view.getQuerySuggestion(this.value);if(k){c("Input").setValue(this.element,k);this.checkValue();event.kill()}else i.handleTab.call(this,event)};j.prototype.getSearchType=function(){"use strict";return"regular"};j.prototype.focus=function(){"use strict";i.focus.call(this);if(this.getValue().length===0||this.element.getAttribute("singlestate")==="true")this.data.fetchNullState(this.getValue())};j.prototype.keyup=function(event){"use strict";if(this.getValue().length===0&&c("Event").getKeyCode(event)===c("Keys").ESC)return;if(this.getValue().length===0)this.data.fetchNullState(this.getValue());this.element.setAttribute("singlestate",false)};f.exports=j}),null);
__d("SearchTypeaheadRecorder",["AsyncRequest","Banzai","BanzaiNectar","BanzaiScuba","CurrentUser","Event","FacebarGlobalOptions","Keys","TokenizeUtil","Vector","clickRefAction","ge","mapObject","throttle","whitelistObjectKeys"],(function a(b,c,d,e,f,g){__p&&__p();var h={WAITING:"WAITING",SUCCESS:"SUCCESS",NO_RESULTS:"NO_RESULTS",ERROR:"ERROR"};function i(k){"use strict";this.init(k);this.initEvents(k)}i.prototype.init=function(k){"use strict";__p&&__p();this.core=k.getCore();this.data=k.getData();this.view=k.getView();this.element=this.core.getElement();this.initTime=Date.now();this._onloadTime=0;this._extraRecorder=[];this.performanceTimings={};this.allFromSingleState=false;this.allFromNullState=false;var l=c("ge")("search_first_focus");this.initStartTime=l&&l.value;this.bootstrapStats={bootstrapped:0};this.type="legacy_search";this._reset()};i.prototype._reset=function(){"use strict";__p&&__p();this.stats={};this.avgStats={};this.appendStats={};this._backspacing=false;this.backendQueries=[];this.backendQueriesStatus={};this._topreplace=false;this._inflightRequests={};var k=Math.random().toString();this.data.setQueryData({sid:k});this.view.setSid(k);this.recordStat("sid",k);this.recordStat("keypressed",0)};i.prototype.initEvents=function(){"use strict";__p&&__p();this.core.subscribe("focus",function(event){if(!this.stats.session_start_time){this.recordStat("session_start_time",Date.now());var k=new Date(),l=k.getTimezoneOffset(),m=Date.now()-l*60*1e3;this.recordStat("session_start_time_user_timezone",m);this._lastRenderTime=0;this._firstKeypressTime=null}}.bind(this));this.core.subscribe("blur",function(event){var k=Date.now();for(var l in this._inflightRequests){var m=this._inflightRequests[l],n=k-m;this.recordAvgStat("search_endpoint_ms_from_js",n)}this.recordStat("session_end_time",k);this.submit()}.bind(this));this.view.subscribe("select",function(k,l){this.recordStat("time_between_select_and_last_render",Date.now()-this._lastRenderTime);if(this._firstKeypressTime!=null)this.recordStat("keypress_to_select_time",Date.now()-this._firstKeypressTime);this.recordSelectInfo(l)}.bind(this));this.view.subscribe("render",function(k,l){this._lastRenderTime=Date.now();this.recordRender(l)}.bind(this));this.data.subscribe("logPerformanceTiming",function(k,l){this.performanceTimings[l.field]=l.value}.bind(this));this.data.subscribe("logProxygenForkPoolId",function(k,l){this.recordStat(l.field,l.value)}.bind(this));this.data.subscribe("activity",function(k,l){this.recordStat("pending_request",l.activity)}.bind(this));this.data.subscribe("respondValidUids",function(k,l){this.validUids=l.slice(0)}.bind(this));this.data.subscribe("beforeQuery",function(k,l){__p&&__p();if(!l.value){this.query="";this.results=[];this.data.lastNullOrSingleStateFetchStartTime=Date.now();return}if(!this.stats.first_query_time)this.recordStat("first_query_time",Date.now());this.query=l.value;if(!this.queryStartTime)this.queryStartTime=[];this.queryStartTime[this.query]=Date.now();this.recordCountStat("num_queries")}.bind(this));this.data.subscribe("queryEndpoint",function(k,l){this.recordCountStat("num_search_ajax_requests");this.recordAvgStat("endpoint_query_length",l.value.length);this._inflightRequests[l.value]=Date.now()}.bind(this));this.data.subscribe("onload",function(k,l){this._onloadTime=l.time}.bind(this));this.data.subscribe("bootstrapped",function(k,l){this.bootstrapStats.endTime=l.time;this.bootstrapStats.bootstrapped=1}.bind(this));this.core.subscribe("recordFunction",function(k,l){this._extraRecorder.push(l)}.bind(this));this.data.subscribe("endpointStats",function(k,l){__p&&__p();var m=l.info,n=m.fetch_end-m.fetch_start;if(m.value)this.recordAvgStat("search_endpoint_ms_from_js",n);else this.bootstrapStats[m.type]=n;if(m.coeff2_ts)this.bootstrapStats.coeff2_ts=m.coeff2_ts;if(typeof m.browserCacheHit!="undefined")this.recordCountStat(m.browserCacheHit?"bootstrap_cachehits":"bootstrap_cachemisses");if(this._inflightRequests[m.value])delete this._inflightRequests[m.value]}.bind(this));this.data.subscribe("fetchComplete",function(k,l){var m=l.entries,n=l.value;if(n&&this.backendQueriesStatus[n]){this._addDurationForBackendQuery(this.backendQueriesStatus[n]);this.backendQueriesStatus[n].status=m&&m.length>0?h.SUCCESS:h.NO_RESULTS}}.bind(this));this.data.subscribe("fetchError",function(k,l){var m=l.fetch_context,n=m.value;if(m.bootstrap||!n)return;if(this.backendQueriesStatus[n]){this.backendQueriesStatus[n].status=h.ERROR;this._addDurationForBackendQuery(this.backendQueriesStatus[n])}}.bind(this));this.data.subscribe("query",function(k,l){this.recordAvgStat("num_results_from_cache",l.results.length)}.bind(this));this.data.subscribe("backend_topreplace",function(k,l){if(false===this._topreplace){this.recordStat("backend_topreplace",1);this._topreplace=true}}.bind(this));this.data.subscribe("completeFetch",function(k,l){if(this.core.scubaInfo){var m=l.response,n={recv:l.stats.fetch_end-l.stats.fetch_start,render:Date.now()-l.stats.fetch_start,payload_size:JSON.stringify(m).length};if(!m.payload.entities)m.payload.entities=this.buildResults();this.logToScuba(m,n,this.core.scubaInfo,this.query,this.type)}}.bind(this));this.data.subscribe("completeCacheFetch",c("throttle")(function(k,l){if(this.core.scubaInfo)this.logToScuba({},{},this.core.scubaInfo,this.query,this.type)}.bind(this),500));c("Event").listen(this.element,"keydown",function(event){__p&&__p();this.recordStat("keypressed",1);this.recordCountStat("count_keys_pressed");if(c("Event").getKeyCode(event)==c("Keys").BACKSPACE){if(!this._backspacing&&this.query){this._backspacing=true;this.recordAppendStat("before_backspace_queries",this.query)}}else this._backspacing=false;if(this._firstKeypressTime==null)this._firstKeypressTime=Date.now()}.bind(this));this.data.subscribe("beforeFetch",function(k,l){var m=l.request.data?l.request.data.value:null;if(!m)return;this.backendQueries.push(m);this.backendQueriesStatus[m]={status:h.WAITING,start_time:Date.now()}}.bind(this))};i.prototype.recordStat=function(k,l){"use strict";this.stats[k]=l};i.prototype.recordCountStat=function(k){"use strict";var l=this.stats[k];this.stats[k]=l?l+1:1};i.prototype.recordAvgStat=function(k,l){"use strict";if(this.avgStats[k]){this.avgStats[k][0]+=l;++this.avgStats[k][1]}else this.avgStats[k]=[l,1]};i.prototype.recordAppendStat=function(k,l){"use strict";if(!Object.prototype.hasOwnProperty.call(this.appendStats,k))this.appendStats[k]=[];this.appendStats[k].push(l)};i.prototype.recordRender=function(k){"use strict";__p&&__p();this.results=k.filter(function(v){return v.uid!="search"&&v.type!="disabled_result"&&v.type!="header"}).map(function(v){return babelHelpers["extends"]({},v)});var l=null;if(this.queryStartTime)l=this.queryStartTime[this.query];var m=this.results.every(function(v){return v.fromCache||v.isSeeMore}),n=this.results.every(function(v){return v.isFromGSEF||v.fromCache||v.isSeeMore||v.isJSBootstrapMatch})&&this.results.some(function(v){return v.isFromGSEF}),o=this.results.every(function(v){return v.isGloballyCachedKeyword||v.fromCache||v.isSeeMore||v.isJSBootstrapMatch})&&this.results.some(function(v){return v.isGloballyCachedKeyword}),p=this.results.every(function(v){return v.isNullState}),q=this.results.every(function(v){return v.isSingleState}),r=this.results.every(function(v){return v.exactMatchKeyword||v.isSeeMore});this.allFromSingleState=q;this.allFromNullState=p;if(this.results.length&&this.data.lastNullOrSingleStateFetchStartTime&&p){this.recordStat("time_render_null_state",Date.now()-this.data.lastNullOrSingleStateFetchStartTime);this.data.lastNullOrSingleStateFetchStartTime=null}else if(this.data.lastNullOrSingleStateFetchStartTime&&this.results.length&&q)this.recordStat("time_render_single_state",Date.now()-this.data.lastNullOrSingleStateFetchStartTime);else if(l){var s=Date.now()-l;if(r)this.recordAppendStat("times_render_gs_echo",s);else this.recordAppendStat(m?"times_render_local":"times_render_remote",s);if(!m&&n)this.recordAppendStat("time_render_gs_early_fetch",s);if(!m&&o)this.recordAppendStat("time_render_globally_cached_keywords",s);if(!m&&!n&&!o)this.recordAppendStat("time_render_remote_main_call",s)}this.data.lastNullOrSingleStateFetchStartTime=null;var t=c("Vector").getViewportDimensions();this.recordStat("window_size_width",t.x);this.recordStat("window_size_height",t.y);if(this.results.length>0&&!this.stats.first_result_time)this.recordStat("first_result_time",Date.now());var u="typed";if(this.allFromNullState)u="nullstate";else if(this.allFromSingleState)u="singlestate";this.recordStat("last_state",u)};i.prototype.recordSelectInfo=function(k){"use strict";__p&&__p();var l=k.selected,m=k.index;if(l.groupIndex!==undefined)m=k.index-l.groupIndex-1;var n={href:l.path},o=l.dataGT?{gt:JSON.parse(l.dataGT)}:{};c("clickRefAction")("click",n,null,null,o);if(l.uid=="search"||l.uid=="people_search"){this.recordStat("selected_position",this.results!=null?this.results.length:0);this.recordStat("selected_search",1)}else if(l.uid=="invite")this.recordStat("selected_invite",1);else{var p=l.log_type||l.rankType||l.render_type||l.type,q=p=="friend"?"user":p;this.recordStat("selected_"+q,1);this.recordStat("selected_position",m);this.recordStat("selected_type",p);this.recordStat("selected_name_length",l.text.length);this.recordStat("selected_id",l.uid);this.recordStat("selected_degree",l.bootstrapped?1:2);this.recordStat("selected_recent_search",l.recent_search);var r=c("TokenizeUtil").parse(this.data.getTextToIndex(l)).tokens,s=j(r,this.query);if(s)this.recordStat("matched_terms",s);this.recordStat("selected_text",l.text)}var t={};this._extraRecorder.forEach(function(u){u(k,this.results,t)}.bind(this));this.recordStat("extra_select_info",JSON.stringify(t));this.recordStat("selected_with_mouse",k.clicked?1:0)};i.prototype._addDurationForBackendQuery=function(k){"use strict";if(k.start_time){k.duration=Date.now()-k.start_time;delete k.start_time}};i.prototype._dataToSubmit=function(){"use strict";__p&&__p();this.recordStat("candidate_results",this.buildResults());this.recordStat("query",this.query);this.recordStat("init_time",this.initTime);if(this.initStartTime){this.recordStat("init_start_time",this.initStartTime);this.recordStat("onload_time",this._onloadTime);this.initStartTime=0}this.recordStat("bootstrapped",this.bootstrapStats.bootstrapped);if(this.bootstrapStats.endTime){this.recordStat("bootstrapped_time",this.bootstrapStats.endTime);this.recordStat("user_bootstrap_ms",this.bootstrapStats.user);this.recordStat("other_bootstrap_ms",this.bootstrapStats.other);this.bootstrapStats.endTime=0}var k=this.data.getBootstrapError();if(k)this.recordStat("bootstrap_error",1);this.recordStat("coeff2_ts",this.bootstrapStats.coeff2_ts);this.recordStat("max_results",this.data._maxResults);if(this.backendQueries.length>0){if(this.backendQueries.length>this.data.logBackendQueriesWindow)this.backendQueries=this.backendQueries.slice(this.backendQueries.length-this.data.logBackendQueriesWindow);this.recordStat("backend_queries",this.backendQueries);var l=c("whitelistObjectKeys")(this.backendQueriesStatus,this.backendQueries);c("mapObject")(l,this._addDurationForBackendQuery,this);this.recordStat("backend_queries_status",l)}if(c("FacebarGlobalOptions").taSessionLoggingSample){var m=[];this.results.forEach(function(r){m.push([r.text||"",r.category||"",r.subtext||""])});this.recordStat("raw_suggestions_text",m)}var n=this.stats;for(var o in this.avgStats){var p=this.avgStats[o];n[o]=p[0]/p[1]}for(var q in this.appendStats)n[q]=JSON.stringify(this.appendStats[q]);return n};i.prototype.buildResults=function(){"use strict";var k=(this.results||[]).map(function(l,m){var n=c("TokenizeUtil").parse(this.data.getTextToIndex(l)).tokens,o=l.rankType||l.render_type||l.type,p=l.log_type,q=l.bootstrapped?1:0,r=l.s_token||"",s=typeof l.index=="undefined"?100:l.index,t=j(n,this.query)||this.query,u=l.index_rank,v=l.match_type,w=l.l_type,x=l.vertical_type,y=l.prefix_match,z=l.prefix_length,A=l.text,B=l.category,C=l.subtext,D=l.fromCache,E=l.isNullState,F=l.isSingleState,G=l.logInfo;if(typeof l.groupIndex=="number")return[l.groupIndex,l.indexInGroup,l.uid,o,q,r,t,u,v,y,z,l.origIndex,w,x,A,B,C,s,D,E,F,G,p];return[0,m,l.uid,o,q,r,t,u,v,y,z,l.origIndex,w,x,A,B,C,s,D,E,F,G,p]}.bind(this));return JSON.stringify(k)};i.prototype.submit=function(){"use strict";var k=this._dataToSubmit();switch(this.data.recordingRoute){case"banzai_vital":c("Banzai").post(this._banzaiRoute,k,{delay:0,retry:true});break;default:this.submitThroughAsyncRequest(k)}this._reset()};i.prototype.addLatencyToSample=function(k,l,m,n){"use strict";__p&&__p();k.addInteger(n+"query_start",m.queryStart);k.addInteger(n+"query_end",m.queryEnd);k.addInteger(n+"keypress_query_end",m.keyPressToQueryEnd);k.addInteger(n+"render",m.render);k.addInteger(n+"keypress_render",m.keyPressToRender);l[n+"query_start"]=m.queryStart;l[n+"query_end"]=m.queryEnd;l[n+"keypress_query_end"]=m.keyPressToQueryEnd;l[n+"render"]=m.render;l[n+"keypress_render"]=m.keyPressToRender};i.prototype.logToScuba=function(k,l,m,n,o){"use strict";__p&&__p();var p={},q=new(c("BanzaiScuba"))("search_facebar_js",null,{addBrowserFields:true,addPredictedGeographyFields:true,addUser:true,addSearchVersion:true,addGatekeepers:{facebarGKs:true}});q.addInteger("sample_rate",m.sample_rate);p.sample_rate=m.sample_rate;q.addNormal("site",m.site);p.site=m.site;q.addDenorm("query",n);p.query=n;var r=k.payload||{};if(r.entities){q.addInteger("num_entities",r.entities.length);p.num_entities=r.entities.length}Object.keys(this.performanceTimings).forEach(function(t){q.addInteger(t,this.performanceTimings[t]);p[t]=this.performanceTimings[t]}.bind(this),this);if(r.results||r.entries){var s=(r.results||r.entries).length;q.addInteger("num_results",s);p.num_results=s}if(r.gzipped_payload_size!==undefined){q.addInteger("gzipped_payload_size",r.gzipped_payload_size);p.gzipped_payload_size=r.gzipped_payload_size}if(l.recv&&l.render>l.recv){q.addInteger("time_render",l.render-l.recv);p.time_render=l.render-l.recv;q.addInteger("time_js_async",l.recv);p.time_js_async=l.recv}if(l.payload_size){q.addInteger("payload_size",l.payload_size);p.payload_size=l.payload_size}if(this.stats.time_render_null_state&&(!n||n.length===0)){q.addInteger("time_render_null_state",this.stats.time_render_null_state);p.time_render_null_state=this.stats.time_render_null_state}q.addInteger("query_id",k.queryId);p.query_id=k.queryId;q.addDenorm("user_id",c("CurrentUser").getID());p.user_id=c("CurrentUser").getID();q.addDenorm("session_id",this.stats.sid);p.session_id=this.stats.sid;q.addNormal("typeahead_type",o);p.typeahead_type=o;if(l.remoteQueryLatencies){this.addLatencyToSample(q,p,l.remoteQueryLatencies,"remote_");q.addInteger("remote_keypress_query_dispatch",l.remoteQueryLatencies.keyPressToQueryDispatch);p.remote_keypress_query_dispatch=l.remoteQueryLatencies.keyPressToQueryDispatch;q.addInteger("remote_keypress_query_start",l.remoteQueryLatencies.keyPressToQueryStart);p.remote_keypress_query_start=l.remoteQueryLatencies.keyPressToQueryStart;q.addNormal("inflight_requests",l.remoteQueryLatencies.inflightRequests);q.addInteger("inflight_requests",l.remoteQueryLatencies.inflightRequests);p.inflight_requests=l.remoteQueryLatencies.inflightRequests;q.addNormal("waiting_queries",l.remoteQueryLatencies.waitingQueries);q.addInteger("waiting_queries",l.remoteQueryLatencies.waitingQueries);p.waiting_queries=l.remoteQueryLatencies.waitingQueries}if(l.cacheQueryLatencies)this.addLatencyToSample(q,p,l.cacheQueryLatencies,"cache_");q.post();c("BanzaiNectar").log("search_facebar_js","typeahead",p)};i.prototype.submitThroughAsyncRequest=function(k){"use strict";if(Object.keys(k).length>0)new(c("AsyncRequest"))().setURI(this._endPoint).setMethod("POST").setData({stats:k}).setOption("handleErrorAfterUnload",true).setErrorHandler(function(l){k.retry=true;new(c("AsyncRequest"))().setURI(this._endPoint).setMethod("POST").setData({stats:k}).setOption("asynchronous_DEPRECATED",false).send()}.bind(this)).send()};var j=function j(k,l){__p&&__p();if(!k||!l)return;var m=c("TokenizeUtil").parse(l);if(m.flatValue[m.flatValue.length-1]===" ")return m.flatValue;var n=m.tokens[m.tokens.length-1],o={};k.forEach(function(s){o[s]=(o[s]||0)+1});var p={},q=m.tokens.slice(0,m.tokens.length-1);q.forEach(function(s){p[s]=(p[s]||0)+1});for(var r=0;r<k.length;++r){var s=k[r];if(s.indexOf(n)===0&&o[s]-(p[s]||0)>0){q.push(s);return q.join(" ")}}return undefined};Object.assign(i.prototype,{_endPoint:"/ajax/typeahead/record_metrics.php",_banzaiRoute:"search"});f.exports=i}),null);
__d("SearchTypeaheadView",["csx","cx","fbt","Arbiter","ContextualLayerUpdateOnScroll","ContextualTypeaheadView","DOM","FbtResultBase","SearchPeopleFriendsOf","SearchPeopleFriendsOfOptions","SearchPeopleSeeMore","SearchPeopleSeeMoreOptions","URI","goURI","isEmail"],(function a(b,c,d,e,f,g,h,i,j){__p&&__p();var k,l;k=babelHelpers.inherits(m,c("ContextualTypeaheadView"));l=k&&k.prototype;function m(o,p){"use strict";l.constructor.call(this,o,p);this._peopleSeeMore=new(c("SearchPeopleSeeMore"))(this.getSeeMoreEndpoint("",true),c("SearchPeopleSeeMoreOptions"));this._peopleFriendsOf=new(c("SearchPeopleFriendsOf"))(this.getSeeMoreEndpoint("",true),c("SearchPeopleFriendsOfOptions"))}m.prototype.initializeLayer=function(){"use strict";l.initializeLayer.call(this);this.layer.setOffsetY(-1);this.layer.enableBehavior(c("ContextualLayerUpdateOnScroll"))};m.prototype.ignoreClick=function(event){"use strict";event.prevent()};m.prototype.render=function(o,p,q){"use strict";__p&&__p();if(!p)return;if(this._bucketize)p=n(p);if(this.showPeopleSeeMore&&o)this._peopleSeeMore.injectInto(p,o);if(this.showPeopleFriendsOf&&o)this._peopleFriendsOf.injectInto(p,o);var r={results:p,value:o};this.inform("finalResultsReordering",r);return l.render.call(this,o,r.results,q)};m.prototype.disableBucketization=function(){"use strict";this._bucketize=false};m.prototype.buildBuckets=function(o,p){"use strict";__p&&__p();var q=p.length,r=0,s;for(s=0;s<q;++s)if(p[s].type=="user")r++;this._redirectToUsersResultsPage=this.showFilterResults&&r===q;this.setWebSuggLoggingParams(o,p);if(!o&&this.showFindPeople)p.unshift(this.buildFindPeople());if(this._bucketize)p=l.buildBuckets.call(this,o,p);if(o&&this._shouldShowSeeMore){p.push(this.buildSeeMore(o,q));if(c("isEmail")(o)&&r<1)p.push(this.buildInvite(o))}return p};m.prototype.buildFindPeople=function(){"use strict";var o=j._("Find people");return{classNames:"seeAllUser seeAllUserNullState",logType:"grammar",path:this.getSeeMoreEndpoint(null,true),photo:"/images/search_typeahead/people_see_more.png",text:o,type:"no_header"}};m.prototype.buildSeeMore=function(o,p){"use strict";var q=this.getSeeMoreText(o,p),r="seeMoreV2",s="calltoactionV2",t=c("DOM").create("span",{className:"simpleSearchSeeMoreRowRedesignIcon"}),u=c("DOM").create("li",{className:s},[t,c("DOM").create("a",{href:this.getSeeMoreEndpoint(o),rel:"ignore"},[c("DOM").create("span",{className:"text"},[c("DOM").create("span",{className:r},q)])])]);if(q instanceof c("FbtResultBase"))u.setAttribute("aria-label",q.flattenToArray());else u.setAttribute("aria-label",q);return{uid:"search",node:u,search:true}};m.prototype.getSeeMoreText=function(o,p){"use strict";if(this.showKeywordResultsPage)return j._("Search for {query}",[j.param("query",o)]);if(p<=0)return j._("See results for {query}",[j.param("query",o)]);if(this._redirectToUsersResultsPage)return j._("Filter results for {query}",[j.param("query",o)]);var q=c("DOM").create("b",{},o);return j._("Find more results for {query}",[j.param("query",q)])};m.prototype.getSeeMoreSubtext=function(o){"use strict";if(o===0)return j._("No results to display");if(o===1)return j._("Displaying top result");return j._({"*":"Displaying top {number} results"},[j.param("number",o,[0])])};m.prototype.buildInvite=function(o){"use strict";var p=j._("Invite {query} to Facebook",[j.param("query",o)]),q=c("DOM").create("li",{className:"calltoaction"},[c("DOM").create("a",{href:this.getInviteEndpoint(o),rel:"ignore"},[c("DOM").create("span",{className:"text"},[c("DOM").create("span",{className:"invite"},[p])])])]);if(p instanceof c("FbtResultBase"))q.setAttribute("arial-label",p.flattenToArray());else q.setAttribute("aria-label",p);return{uid:"invite",node:q,search:true}};m.prototype.searchPageQueryData=function(o){"use strict";return babelHelpers["extends"]({q:o},this.queryData||{})};m.prototype.searchPageTypeData=function(o){"use strict";return this._redirectToUsersResultsPage||o?{type:"users"}:{}};m.prototype.select=function(o){"use strict";__p&&__p();var p=this.index,q=this.results[p];if(!q||q.type=="header")return;var r=this.items[p],s=c("DOM").scry(r,"a")[0];l.select.call(this,o);if(s&&s.href)if(s.target=="_blank")window.open(s.href);else c("goURI")(s.href)};m.prototype.setSid=function(o){"use strict";this.queryData.tas=o};m.prototype.getSeeMoreEndpoint=function(o,p){"use strict";return new(c("URI"))(this.seeMoreEndpoint).addQueryData(this.searchPageQueryData(o)).addQueryData(this.searchPageTypeData(p)).toString()};m.prototype.getInviteEndpoint=function(o){"use strict";return new(c("URI"))("/invite.php").addQueryData({email_list:o})};m.prototype.show=function(){"use strict";if(!this.isVisible()){c("Arbiter").inform("layer_shown",{type:"SearchTypeahead"});this.searchBtns=this.searchBtns||c("DOM").scry(this.typeahead,"button.reDesignedBtn");if(this.searchBtns[0])CSS.addClass(this.searchBtns[0],"btnSelected");l.show.call(this)}};m.prototype.hide=function(){"use strict";if(this.isVisible()){c("Arbiter").inform("layer_hidden",{type:"SearchTypeahead"});this.searchBtns=this.searchBtns||c("DOM").scry(this.typeahead,"button.reDesignedBtn");if(this.searchBtns[0]&&CSS.matchesSelector(this.searchBtns[0],".btnSelected"))CSS.removeClass(this.searchBtns[0],"btnSelected");l.hide.call(this)}};m.prototype.getQuerySuggestion=function(o){"use strict";var p=this.results[this.index],q=p&&p.type!="header"?p.text.toLowerCase():"";return q==o.toLowerCase()?"":q};m.prototype.setWebSuggLoggingParams=function(o,p){"use strict";__p&&__p();var q=0,r=0;for(var s=0;s<p.length;s++)if(p[s].type==="websuggestion"){if(r===0)r=s+1;var t="FR"+(s-q)+"AS"+q,u=s+1;p[s].path+="&wssk="+t+"&wssp="+u+"&wspq="+encodeURIComponent(o);p[s].path+="&wssrc="+p[s].websuggestion_source;q++}var v="&wssc="+p.length+"-"+o.length+"&wsbp="+q+"-"+r;for(s=0;s<p.length;s++)if(p[s].type==="websuggestion")p[s].path+=v};function n(o){__p&&__p();var p,q,r,s,t=[],u={};q=o.length;for(p=0;p<q;p++){r=o[p];s=r.render_type||r.type;if(!Object.prototype.hasOwnProperty.call(u,s)){u[s]=t.length;t.push([])}t[u[s]].push(r)}var v=[];q=t.length;for(p=0;p<q;++p){r=t[p][0];s=r.render_type||r.type;v=v.concat(t[p])}return v}Object.assign(m.prototype,{_shouldShowSeeMore:true,_bucketize:true,queryData:{init:"quick"}});f.exports=m}),null);
__d("SimpleSearchNavigation",["Arbiter","DOMQuery","Input","QueryHistory","URI"],(function a(b,c,d,e,f,g){__p&&__p();var h=null,i=null,j={registerInput:function k(l,m){i=c("DOMQuery").scry(l,"input")[0];if(h)this._updateTitle(h,m);c("Arbiter").subscribe("page_transition",function(n,o){this._updateTitle(c("QueryHistory").get(o.uri))}.bind(this))},_updateTitle:function k(l,m){if(i){c("Input").setValue(i,l||"");i.setAttribute("singlestate",l&&m);i.blur()}},setPageTitle:function k(l,m){c("QueryHistory").set(c("URI").getNextURI(),l);if(i)this._updateTitle(l,m);else h=l;var n={};c("Arbiter").inform("search/updateNullState",n,c("Arbiter").BEHAVIOR_STATE)},setPageQuery:function k(l){c("Arbiter").inform("search/updateNullState",l,c("Arbiter").BEHAVIOR_STATE)}};f.exports=j}),null);
__d("XSearchFacebarSurveyController",["XController"],(function a(b,c,d,e,f,g){f.exports=c("XController").create("/search/facebar_survey/",{id:{type:"String",required:true},query:{type:"String"},session_id:{type:"String",required:true},on_session_start:{type:"Exists",defaultValue:false},result_selected:{type:"Exists",defaultValue:false}})}),null);
__d("AbandonedSessionSurvey",["AsyncRequest","SubscriptionsHandler","XSearchFacebarSurveyController","getOrCreateDOMID"],(function a(b,c,d,e,f,g){__p&&__p();function h(i){"use strict";__p&&__p();this.tryToSubmitSurvey=function(){if(this.searchBoxFocused){this.openSurvey();this.resultSelected=false;this.searchBoxFocused=false}}.bind(this);this.core=i.getCore();this.data=i.getData();this.view=i.getView();this.subscriptionsHandler=new(c("SubscriptionsHandler"))()}h.prototype.enable=function(){"use strict";this.subscriptionsHandler.addSubscriptions(this.core.subscribe("focus",function(){this.searchBoxFocused=true;this.resultSelected=false}.bind(this)),this.data.subscribe("beforeQuery",function(i,j){this.query=j.value||""}.bind(this)),this.view.subscribe("select",function(){this.resultSelected=true;this.tryToSubmitSurvey()}.bind(this)),this.core.subscribe("blur",this.tryToSubmitSurvey))};h.prototype.disable=function(){"use strict";this.subscriptionsHandler.release();this.request&&this.request.abort()};h.prototype.openSurvey=function(){"use strict";__p&&__p();if(this.openedSurvey)return;this.openedSurvey=true;var i=this.core.element;if(i==null)i=this.core.getElement();var j=this.normalizeValue(this.query),k=c("XSearchFacebarSurveyController").getURIBuilder().setString("id",c("getOrCreateDOMID")(i)).setString("query",j!=null?j:"").setString("session_id",this.data.queryData.sid).setExists("result_selected",this.resultSelected);this.request=new(c("AsyncRequest"))().setMethod("POST").setAllowCrossPageTransition(true).setURI(k.getURI());this.request.send()};h.prototype.normalizeValue=function(i){"use strict";return String(i).trim().replace(/\s+/g," ").replace(/[\u200E|\u200F|\u202a|\u202b|\u202c]/g,"").toLowerCase()};f.exports=h}),null);
__d("TypeaheadSearchFilter",["Arbiter"],(function a(b,c,d,e,f,g){__p&&__p();function h(i){"use strict";this._typeahead=i}h.prototype.enable=function(){"use strict";__p&&__p();var i=this._typeahead,j=i.getView().seeMoreEndpoint;this._subscriptions=[c("Arbiter").subscribe("search/typeahead/updateFilter",function(k,l){if(l.filter_type=="web")i.getView().queryData.form="FBKBFR";i.getView().queryData.type=l.filter_type}),c("Arbiter").subscribe("search/typeahead/updateSeeMoreEndpoint",function(k,l){i.getView().seeMoreEndpoint=l}),c("Arbiter").subscribe("page_transition",function(k,l){if(i.getView().queryData.form)delete i.getView().queryData.form;delete i.getView().queryData.type;i.getView().seeMoreEndpoint=j},c("Arbiter").SUBSCRIBE_NEW)]};h.prototype.disable=function(){"use strict";this._subscriptions.forEach(function(i){i.unsubscribe()});this._subscriptions=null};Object.assign(h.prototype,{_subscription:null});f.exports=h}),null);
__d("legacy:SearchFilterTypeaheadBehavior",["TypeaheadSearchFilter"],(function a(b,c,d,e,f,g){if(!b.TypeaheadBehaviors)b.TypeaheadBehaviors={};b.TypeaheadBehaviors.initFilters=function(h){h.enableBehavior(c("TypeaheadSearchFilter"))}}),3);
__d("TypeaheadSearchRecorderBasic",["SearchTypeaheadRecorder","emptyFunction"],(function a(b,c,d,e,f,g){function h(i){"use strict";this._typeahead=i}h.prototype.enable=function(){"use strict";new(c("SearchTypeaheadRecorder"))(this._typeahead)};Object.assign(h.prototype,{disable:c("emptyFunction")});f.exports=h}),null);
__d("legacy:SearchRecorderBasicTypeaheadBehavior",["TypeaheadSearchRecorderBasic"],(function a(b,c,d,e,f,g){if(!b.TypeaheadBehaviors)b.TypeaheadBehaviors={};b.TypeaheadBehaviors.searchRecorderBasic=function(h){h.enableBehavior(c("TypeaheadSearchRecorderBasic"))}}),3);
__d("SessionStartSurvey",["AsyncRequest","SubscriptionsHandler","XSearchFacebarSurveyController","getOrCreateDOMID"],(function a(b,c,d,e,f,g){__p&&__p();function h(i){"use strict";this.core=i.getCore();this.data=i.getData();this.subscriptionsHandler=new(c("SubscriptionsHandler"))()}h.prototype.enable=function(){"use strict";this.subscriptionsHandler.addSubscriptions(this.data.subscribe("query",function(){this.openSurvey()}.bind(this)))};h.prototype.disable=function(){"use strict";this.subscriptionsHandler.release();this.request&&this.request.abort()};h.prototype.openSurvey=function(){"use strict";if(this.openedSurvey)return;this.openedSurvey=true;var i=c("XSearchFacebarSurveyController").getURIBuilder().setString("id",c("getOrCreateDOMID")(this.core.element)).setExists("on_session_start",true).setString("session_id",this.data.queryData.sid);this.request=new(c("AsyncRequest"))().setMethod("POST").setURI(i.getURI());this.request.send()};f.exports=h}),null);
__d("TypeaheadDetectQueryLocale",[],(function a(b,c,d,e,f,g){__p&&__p();function h(i){"use strict";this._typeahead=i;this._data=i.getData();this._queryCache={"":this._data.queryCache,ja_JP:{},zh_TW:{}}}h.prototype.enable=function(){"use strict";__p&&__p();this._previousLocale="";this._reset=this._typeahead.subscribe("reset",this._swapQueryCache.bind(this,""));this._beforeQuery=this._data.subscribe("beforeQuery",function(i,j){__p&&__p();var k=j.value;if(k===""){this._swapQueryCache("");return}var l=null,m=k.charCodeAt(k.length-1);if(12352<=m&&m<=12543)l="ja_JP";else if(12544<=m&&m<=12735)l="zh_TW";this._swapQueryCache(l)}.bind(this))};h.prototype.disable=function(){"use strict";this._swapQueryCache("");this._data.unsubscribe(this._beforeQuery);this._typeahead.ubsubscribe(this._reset)};h.prototype._swapQueryCache=function(i){"use strict";if(i===null||i===this._previousLocale)return;this._data.queryCache=this._queryCache[i];this._data.setQueryData({query_locale:i});this._previousLocale=i};f.exports=h}),null);
__d("TypeaheadExcludeBootstrapFromQueryCache",[],(function a(b,c,d,e,f,g){__p&&__p();function h(i){"use strict";this._data=i.getData()}h.prototype.enable=function(){"use strict";this._buildingQueryCache=false;this._buildQueryCache=this._data.subscribe("buildQueryCache",function(){this._buildingQueryCache=true}.bind(this));this._mergeUids=this._data.subscribe("mergeUids",function(i,j){if(this._buildingQueryCache)j.local_uids.splice(0,j.local_uids.length)}.bind(this));this._fetchComplete=this._data.subscribe("fetchComplete",function(){this._buildingQueryCache=false}.bind(this))};h.prototype.disable=function(){"use strict";this._data.unsubscribe(this._buildQueryCache);this._data.unsubscribe(this._mergeUids);this._data.unsubscribe(this._fetchComplete)};f.exports=h}),null);
__d("TypeaheadPostSearchRedirect",[],(function a(b,c,d,e,f,g){__p&&__p();function h(i){"use strict";this.view=i.getView()}h.prototype.enable=function(){"use strict";this.view.queryData.ref="ss_see_more_link"};h.prototype.disable=function(){"use strict";delete this.view.queryData.ref};f.exports=h}),null);
__d("TypeaheadRecentSearchUpdater",["Arbiter"],(function a(b,c,d,e,f,g){__p&&__p();function h(i){"use strict";this.view=i.getView()}h.prototype.enable=function(){"use strict";this.updaterSubscription=this.view.subscribe("select",function(){c("Arbiter").inform("search/refreshRecentSearchesNullstate",{},c("Arbiter").BEHAVIOR_STATE)})};h.prototype.disable=function(){"use strict";this.view.unsubscribe(this.updaterSubscription)};f.exports=h}),null);
__d("SearchTypeaheadRenderer",["fbt","BadgeHelper","DOM","Locale","TokenizeUtil","TypeaheadFacepile","URI","UnicodeBidi","WWWBase"],(function a(b,c,d,e,f,g,h){__p&&__p();var i=false;function j(k,l){__p&&__p();var m=[],n=k.photos||k.photo;if(n){if(n instanceof Array)n=c("TypeaheadFacepile").render(n);else n=c("DOM").create("img",{alt:"",src:n});m.push(n)}var o;if(k.text){var p=k.alias,q=this.value,r=k.text,s=c("UnicodeBidi").isDirectionRTL(r.toString()),t=c("Locale").isRTL(),u=s&&!t?"rtl":!s&&t?"ltr":"";o=[r];if(p&&c("TokenizeUtil").isQueryMatch(q,p)&&!c("TokenizeUtil").isQueryMatch(q,r))o.push(c("DOM").create("span",{className:"alias"},[" \xb7 "+p]));if(k.is_verified)o.push(c("BadgeHelper").renderBadge("xsmall","verified"));else if(k.is_work_user)o.push(c("BadgeHelper").renderBadge("xsmall","work"));if(k.badge){o.push(c("DOM").create("span",{className:""}," \xb7 "));var v=[k.badge];o.push(c("DOM").create("span",{className:"unSeenPosts"},v))}m.push(c("DOM").create("span",{className:"text",dir:u},o))}if(k.category){var w=[k.category];if(k.is_external)w.push(c("DOM").create("span",{className:"arrow"}));var x=k.message?"preCategory":"category";m.push(c("DOM").create("span",{className:x},w))}if(k.message)m.push(c("DOM").create("span",{className:"category"},[k.message]));var y=k.subtextOverride||k.subtext;if(y){var z=[y];m.push(c("DOM").create("span",{className:"subtext"},z))}var A=k.classNames||k.type||"",B=k.is_external?"_blank":"",C=!k.song&&k.path||"";if(C){if(!/^https?\:\/\//.test(C))C=c("WWWBase").uri+C.substr(1);C+=(C.indexOf("?")>0?"&":"?")+"ref=ts&fref=ts"}var D=c("DOM").create("a",{href:C,rel:"ignore",target:B},m),E=null;if(k.type==="header"){var F=null,G=null;if(k.uid==="recent"){G=new(c("URI"))("/profile.php");G.setQueryData({sk:"allactivity",log_filter:"search"});F=h._("EDIT")}else if(k.uid==="pymk"){G=new(c("URI"))("/find-friends/browser/");F=h._("SEE ALL")}if(G){E=c("DOM").create("a",{href:G,className:"typeaheadHeaderRightLink"},F);D.setAttribute("class","typeaheadHeaderLeftLink");A+=" typeaheadHeader"}}var H=c("DOM").create("li",{className:A},[D,E]);if(k.text){H.setAttribute("title",k.text);H.setAttribute("aria-label",k.text)}if(this.showupadatedsuggestions&&!i){j.className+=" updatedSuggestionRows";i=true}return H}j.className="search";f.exports=j}),null);
__d("legacy:SearchTypeaheadRenderer",["SearchTypeaheadRenderer"],(function a(b,c,d,e,f,g){if(!b.TypeaheadRenderers)b.TypeaheadRenderers={};b.TypeaheadRenderers.search=c("SearchTypeaheadRenderer")}),3);